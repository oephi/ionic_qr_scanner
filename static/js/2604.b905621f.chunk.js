/*! For license information please see 2604.b905621f.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkqr_code_scanner=self.webpackChunkqr_code_scanner||[]).push([[2604],{2604:function(e,t,r){r.r(t),r.d(t,{DBRWeb:function(){return re}});var n=r(5861),i=r(5671),a=r(3144),o=r(136),s=r(9388),c=r(7757),u=r.n(c),d=r(7991),h=r(4671),l=r(2982),_=r(1120);function g(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,_.Z)(e)););return e}function f(){return f="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,r){var n=g(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},f.apply(this,arguments)}var v=r(7762);function p(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))}"object"==typeof r.g&&r.g.process&&r.g.process.release&&r.g.process.release.name;var m,R,S,E,y="undefined"==typeof self,I=function(){function e(){var t=this;(0,i.Z)(this,e),this._maxCvsSideLength=void 0,this._defaultMaxCvsSideLength=null,this.predefinedResolutions=[{width:160,height:120},{width:320,height:240},{width:480,height:360},{width:640,height:480},{width:800,height:600},{width:960,height:720},{width:1280,height:720},{width:1920,height:1080},{width:2560,height:1440},{width:3840,height:2160}],this.mapCameraResolutions=new Map,this._bWebGLSupported=!0,this._singleFrameMode=!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),this._cvsSingleFrameMode=null,this._imgWidth=0,this._imgHeight=0,this._singleFrameModeIpt=null,this._clickIptSingleFrameMode=function(){if(t.singleFrameMode){if(!t._singleFrameModeIpt){var r=document.createElement("input");t._singleFrameModeIpt=r,r.setAttribute("type","file"),r.setAttribute("accept",".jpg,.jpeg,.icon,.gif,.svg,.webp,.png,.bmp"),r.setAttribute("capture",""),r.addEventListener("change",(function(){return p(t,void 0,void 0,u().mark((function t(){var n,i,a,o,s,c,d,h,l,_,g,f,m,R=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=r.files[0],r.value="",t.next=4,function(e){return p(R,void 0,void 0,u().mark((function t(){var r,n,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null,n=null,"undefined"==typeof createImageBitmap){t.next=12;break}return t.prev=2,t.next=5,createImageBitmap(e);case 5:if(!(r=t.sent)){t.next=8;break}return t.abrupt("return",r);case 8:t.next=12;break;case 10:t.prev=10,t.t0=t.catch(2);case 12:if(t.t1=r,t.t1){t.next=17;break}return t.next=16,i=e,new Promise((function(e,t){var r=URL.createObjectURL(i),n=new Image;n.dbrObjUrl=r,n.src=r,n.onload=function(){e(n)},n.onerror=function(e){t(new Error("Can't convert blob to image : "+(e instanceof Event?e.type:e)))}}));case 16:n=t.sent;case 17:return t.abrupt("return",n);case 18:case"end":return t.stop()}}),t,null,[[2,10]])})))}(n);case 4:i=t.sent,a=i instanceof HTMLImageElement?i.naturalWidth:i.width,o=i instanceof HTMLImageElement?i.naturalHeight:i.height,this._imgWidth=a,this._imgHeight=o,function(e){if(!R._cvsSingleFrameMode){if(R._cvsSingleFrameMode=document.createElement("canvas"),R._cvsSingleFrameMode.className="cvs-single-frame-mode",R._cvsSingleFrameMode.addEventListener("click",R._clickIptSingleFrameMode),R._cvsSingleFrameMode.style.cursor="pointer",R._cvsSingleFrameMode.setAttribute("title","Take a photo"),!R._video)throw new Error("'video' is null.");R._video.after(R._cvsSingleFrameMode)}var t=R._cvsSingleFrameMode;t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.left="0",t.style.top="0",t.style.objectFit="contain",t.width==a&&t.height==o||(t.width=a,t.height=o);var r=t.getContext("2d");r.clearRect(0,0,t.width,t.height),r.drawImage(e,0,0)}(i),this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator(),s=(0,v.Z)(this._arrScanRegionOverlays);try{for(s.s();!(c=s.n()).done;)(d=c.value)&&this._updateScanRegionOverlay(d)}catch(S){s.e(S)}finally{s.f()}h=function(t){var r=Date.now();if(0===a||0===o)return null;var n,i,s=R._scanRegion,c=R.getFrameSize(a,o,s,R.maxCvsSideLength);if(!c)return null;n=a!==c.sWidth||o!==c.sHeight,i=c.sWidth!==c.dWidth||c.sHeight!==c.dHeight;var u=!(!R._bWebGLSupported||i),d={data:null,region:s?JSON.parse(JSON.stringify(s)):null,sx:c.sx,sy:c.sy,width:c.dWidth,height:c.dHeight,colorMode:null,timeSpent:null,timeStamp:null,isCropped:n,toCanvas:R.toCanvas,_bUseWebGL:null},h=R._getImageData(t,a,o,c,null,{targetColorMode:R.frameColorMode,bUseWebGL:u});if(!h)return null;var l=Date.now();return e._onLog&&e._onLog("DCE: _getVideoFrame(region?) END: "+l),d.data=h.data,d.colorMode=h.colorMode,d._bUseWebGL=h._bUseWebGL,d.timeSpent=l-r,d.timeStamp=l,d}(i),l=this.mapCameraEvents.get("singleFrameAcquired"),_=(0,v.Z)(l),t.prev=13,_.s();case 15:if((g=_.n()).done){t.next=28;break}return f=g.value,t.prev=17,m={data:new Uint8Array(h.data),region:JSON.parse(JSON.stringify(h.region)),sx:h.sx,sy:h.sy,width:h.width,height:h.height,colorMode:h.colorMode,timeSpent:h.timeSpent,timeStamp:h.timeStamp,isCropped:h.isCropped,toCanvas:h.toCanvas,_bUseWebGL:h._bUseWebGL},t.next=21,f(m);case 21:t.next=26;break;case 23:t.prev=23,t.t0=t.catch(17),console.error(t.t0);case 26:t.next=15;break;case 28:t.next=33;break;case 30:t.prev=30,t.t1=t.catch(13),_.e(t.t1);case 33:return t.prev=33,_.f(),t.finish(33);case 36:case"end":return t.stop()}}),t,this,[[13,30,33,36],[17,23]])})))})),r.style.position="fixed",r.style.left="-1px",r.style.top="-1px",r.style.width="1px",r.style.height="1px",r.style.backgroundColor="transparent",r.style.color="transparent",document.body.appendChild(r)}t._singleFrameModeIpt.click()}},this.styleEls=[],this._frameColorMode=void 0,this._defaultFrameColorMode="RGBA",this.currentFSColorMode="rgba",this.ifReuseArrayBufferView=!1,this.maxVideoCvsLength=3,this.canvas=null,this.videoGlCvs=null,this.videoGl=null,this.glImgData=null,this.webglTexture=null,this.webglProgramInfo=null,this.webglBuffers=null,this.toCanvas=function(){var e,t=document.createElement("canvas");if(t.width=this.width,t.height=this.height,"grey"===this.colorMode){e=new Uint8ClampedArray(this.width*this.height*4);for(var r=0;r<e.length;r+=4)e[r]=this.data[r/4],e[r+1]=this.data[r/4],e[r+2]=this.data[r/4],e[r+3]=255}else e=new Uint8ClampedArray(this.data);var n=new ImageData(e,this.width,this.height);return t.getContext("2d").putImageData(n,0,0),t},this._onCameraSelChange=function(){return p(t,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.selectCamera(this._selCam.value);case 2:this._bOpen||this.stop();case 3:case"end":return e.stop()}}),e,this)})))},this._onResolutionSelChange=function(){return p(t,void 0,void 0,u().mark((function e(){var t,r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._selRsl&&-1!=this._selRsl.selectedIndex&&(n=this._selRsl.options[this._selRsl.selectedIndex],t=n.getAttribute("data-width"),r=n.getAttribute("data-height")),e.next=3,this.setResolution(t,r);case 3:this._bOpen||this.stop();case 4:case"end":return e.stop()}}),e,this)})))},this._onCloseBtnClick=function(){t.close(!0)},this._bOpen=!1,this.videoSrc=null,this.videoSettings={video:{width:{ideal:1280},height:{ideal:720},facingMode:{ideal:"environment"}}},this.iPlayRound=0,this.promisePlay=null,this._ifSaveLastUsedCamera=!1,this.ifSkipCameraInspection=!1,this._allCameras=[],this._currentCamera=null,this._videoTrack=null,this._lastDeviceId=void 0,this._vc_bPlayingVideoBeforeHide=!1,this._ev_documentHideEvent=function(){"visible"===document.visibilityState?t._vc_bPlayingVideoBeforeHide&&("Firefox"==e.browserInfo.browser?t.play():t._video.play(),t._vc_bPlayingVideoBeforeHide=!1):t._video&&!t._video.paused&&(t._vc_bPlayingVideoBeforeHide=!0,t._video.pause())},this._video=null,this.videoFit="contain",this._cvsScanRegion=null,this._divScanArea=null,this._divScanLight=null,this._bgLoading=null,this._selCam=null,this._bgCamera=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this.regionMaskFillStyle="rgba(0,0,0,0.5)",this.regionMaskStrokeStyle="rgb(254,142,20)",this.regionMaskLineWidth=2,this._bShowScanRegionMask=!0,this._bShowScanRegionLaser=!1,this._scanRegion=null,this._arrScanRegionOverlays=[],this._cvsViewDecorator=null,this._decoratorType=[],this._decoratorArea=null,this._viewDecoratorInfo={rectangle:{lineWidth:4,strokeStyle:"rgb(254,142,20)",fillStyle:"transparent",maskFillStyle:"transparent"},focus:{lineWidth:4,strokeStyle:"rgb(254,142,20)",fillStyle:"transparent",maskFillStyle:"transparent"},crossline:{lineWidth:2,strokeStyle:"rgb(254,142,20)"},crosshair:{lineWidth:4,strokeStyle:"rgb(254,142,20)"}},this._croppingRegions=void 0,this._defaultCroppingRegions=[null],this.bIncreaseRegionIndexAuto=!0,this._croppingRegionIndex=0,this._loopInterval=void 0,this._defaultLoopInterval=0,this._maxNumberOfFramesInBuffer=void 0,this._defaultMaxNumberOfFramesInBuffer=1,this._frameQueue=[],this._bFetchingLoopStarted=!1,this._bStoppedByPause=!1,this._refreshInterval=void 0,this._defaultRefreshInterval=-1,this._updateCanvasTimeout=500,this.referenceConfigurationArray=[],this._onWindowResize=function(){t._resizeTimeoutId&&clearTimeout(t._resizeTimeoutId),t._resizeTimeoutId=setTimeout((function(){t._updateScanRegionCanvas(),t._updateScanAreaDiv(),t._updateViewDecorator();var e,r=(0,v.Z)(t._arrScanRegionOverlays);try{for(r.s();!(e=r.n()).done;){var n=e.value;n&&t._updateScanRegionOverlay(n)}}catch(i){r.e(i)}finally{r.f()}}),t._updateCanvasTimeout)},this.bDestroyed=!1,this.mapCameraEvents=new Map([["cameraOpen",[]],["cameraClose",[]],["cameraChange",[]],["resolutionChange",[]],["played",[]],["singleFrameAcquired",[]],["frameAddedToBuffer",[]]])}return(0,a.Z)(e,[{key:"maxCvsSideLength",get:function(){return void 0!==this._maxCvsSideLength?this._maxCvsSideLength:this.referenceConfigurationArray&&1===this.referenceConfigurationArray.length&&this.referenceConfigurationArray[0].hasOwnProperty("maxCvsSideLength")?this.referenceConfigurationArray[0].maxCvsSideLength:this._defaultMaxCvsSideLength},set:function(e){if(e<=0)throw new Error("The 'maxCvsSideLength' should be greater than 0.");this._maxCvsSideLength=e}},{key:"getUIElement",value:function(){return this.UIElement}},{key:"setUIElement",value:function(e){return p(this,void 0,void 0,u().mark((function t(){var r,n,i,a;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this._bOpen){t.next=2;break}throw new Error("It is not allowed to change the UIElement when the camera is open.");case 2:if(!("string"==typeof e||e instanceof String)){t.next=18;break}if(e.trim().startsWith("<")){t.next=12;break}return t.next=6,fetch(e);case 6:if((r=t.sent).ok){t.next=9;break}throw Error("setUIElement(elementOrUrl): Network Error: "+r.statusText);case 9:return t.next=11,r.text();case 11:e=t.sent;case 12:if(e.trim().startsWith("<")){t.next=14;break}throw Error("setUIElement(elementOrUrl): Can't get valid HTMLElement.");case 14:for((n=document.createElement("div")).innerHTML=e,i=0;i<n.childElementCount;++i)(a=n.children[i])instanceof HTMLStyleElement&&(this.styleEls.push(a),document.head.append(a));(e=1==n.childElementCount?n.children[0]:n).remove();case 18:this.UIElement=e;case 19:case"end":return t.stop()}}),t,this)})))}},{key:"singleFrameMode",get:function(){return this._singleFrameMode},set:function(e){if(this._bOpen)throw new Error("It is not allowed to change `singleFrameMode` when the camera is open.");this._singleFrameMode=e}},{key:"frameColorMode",get:function(){return void 0!==this._frameColorMode?this._frameColorMode:this.referenceConfigurationArray&&1===this.referenceConfigurationArray.length&&this.referenceConfigurationArray[0].hasOwnProperty("frameColorMode")?this.referenceConfigurationArray[0].frameColorMode:this._defaultFrameColorMode},set:function(e){this._frameColorMode=e}},{key:"_bindUI",value:function(){if(!this.UIElement)throw new Error("Need to define `UIElement` before opening.");for(var e=[this.UIElement],t=0;t<e.length;++t){var r,n=(0,v.Z)(e[t].children);try{for(n.s();!(r=n.n()).done;){var i=r.value;e.push(i)}}catch(u){n.e(u)}finally{n.f()}}for(var a=0,o=e;a<o.length;a++){var s=o[a];if(!this._video&&s.classList.contains("dce-video-container")){var c=document.createElement("video");c.style.position="absolute",c.style.left="0",c.style.top="0",c.style.width="100%",c.style.height="100%",c.style.objectFit=this.getVideoFit(),c.setAttribute("playsinline","true"),c.setAttribute("muted","true"),s.prepend(c),this._video=c}else!this._divScanArea&&s.classList.contains("dce-scanarea")?this._divScanArea=s:!this._divScanLight&&s.classList.contains("dce-scanlight")?this._divScanLight=s:!this._bgLoading&&s.classList.contains("dce-bg-loading")?this._bgLoading=s:!this._bgCamera&&s.classList.contains("dce-bg-camera")?this._bgCamera=s:!this._selCam&&s.classList.contains("dce-sel-camera")?this._selCam=s:!this._selRsl&&s.classList.contains("dce-sel-resolution")?(this._selRsl=s,this.videoSrc||this.singleFrameMode||this._selRsl.options.length||(this._selRsl.innerHTML=[this._optGotRsl?"":'<option class="dce-opt-gotResolution" value="got"></option>','<option data-width="1920" data-height="1080">1920x1080</option>','<option data-width="1280" data-height="720">1280x720</option>','<option data-width="640" data-height="480">640x480</option>'].join(""),this._optGotRsl=this._optGotRsl||this._selRsl.options[0])):!this._optGotRsl&&s.classList.contains("dce-opt-gotResolution")?this._optGotRsl=s:!this._btnClose&&s.classList.contains("dce-btn-close")&&(this._btnClose=s)}if(!this._video)throw this._unbindUI(),Error("Can not find the video container element with class 'dce-video-container'");this.singleFrameMode?(this._video&&(this._video.addEventListener("click",this._clickIptSingleFrameMode),this._video.style.cursor="pointer",this._video.setAttribute("title","Take a photo")),this._divScanArea&&(this._divScanArea.addEventListener("click",this._clickIptSingleFrameMode),this._divScanArea.style.cursor="pointer",this._divScanArea.setAttribute("title","Take a photo")),this._bgCamera&&(this._bgCamera.style.display="")):this._bgLoading&&(this._bgLoading.style.display=""),this._selCam&&this._selCam.addEventListener("change",this._onCameraSelChange),this._selRsl&&this._selRsl.addEventListener("change",this._onResolutionSelChange),this._btnClose&&this._btnClose.addEventListener("click",this._onCloseBtnClick),document.addEventListener("visibilitychange",this._ev_documentHideEvent),window.addEventListener("resize",this._onWindowResize)}},{key:"_unbindUI",value:function(){this.singleFrameMode?(this._video&&(this._video.removeEventListener("click",this._clickIptSingleFrameMode),this._video.style.cursor="",this._video.removeAttribute("title")),this._divScanArea&&(this._divScanArea.removeEventListener("click",this._clickIptSingleFrameMode),this._divScanArea.style.cursor="",this._divScanArea.removeAttribute("title")),this._bgCamera&&(this._bgCamera.style.display="none")):this._bgLoading&&(this._bgLoading.style.display="none"),this._selCam&&this._selCam.removeEventListener("change",this._onCameraSelChange),this._selRsl&&this._selRsl.removeEventListener("change",this._onResolutionSelChange),this._btnClose&&this._btnClose.removeEventListener("click",this._onCloseBtnClick),this._cvsViewDecorator&&(this._cvsViewDecorator.removeEventListener("click",this._clickIptSingleFrameMode),this._cvsViewDecorator.style.cursor="",this._cvsViewDecorator.removeAttribute("title"));var e,t=(0,v.Z)(this._arrScanRegionOverlays);try{for(t.s();!(e=t.n()).done;){var r=e.value;r&&(r.removeEventListener("click",this._clickIptSingleFrameMode),r.style.cursor="",r.removeAttribute("title"))}}catch(n){t.e(n)}finally{t.f()}this.hideScanRegionLaser(),this.hideViewDecorator(),this.hideScanRegionOverlays(),this._video&&(this._video.onloadedmetadata=null,this._video.remove()),this._video=null,this._selCam=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._divScanArea=null,this._divScanLight=null,this._cvsScanRegion&&(this._cvsScanRegion.remove(),this._cvsScanRegion=null),this._singleFrameModeIpt&&(this._singleFrameModeIpt.remove(),this._singleFrameModeIpt=null),this._cvsSingleFrameMode&&(this._cvsSingleFrameMode.remove(),this._cvsSingleFrameMode=null),document.removeEventListener("visibilitychange",this._ev_documentHideEvent),window.removeEventListener("resize",this._onWindowResize)}},{key:"bOpen",set:function(e){if(this._bOpen=e,e){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();var t,r=(0,v.Z)(this._arrScanRegionOverlays);try{for(r.s();!(t=r.n()).done;){var n=t.value;n&&this._updateScanRegionOverlay(n)}}catch(s){r.e(s)}finally{r.f()}this._bShowScanRegionMask?this.showScanRegionMask():this.hideScanRegionMask(),this._bShowScanRegionLaser?this.showScanRegionLaser():this.hideScanRegionLaser(),this.showViewDecorator(),this._cvsViewDecorator&&(this._cvsViewDecorator.addEventListener("click",this._clickIptSingleFrameMode),this._cvsViewDecorator.style.cursor="pointer",this._cvsViewDecorator.setAttribute("title","Take a photo")),this.showScanRegionOverlays();var i,a=(0,v.Z)(this._arrScanRegionOverlays);try{for(a.s();!(i=a.n()).done;){var o=i.value;o&&(o.addEventListener("click",this._clickIptSingleFrameMode),o.style.cursor="pointer",o.setAttribute("title","Take a photo"))}}catch(s){a.e(s)}finally{a.f()}}}},{key:"_assertOpen",value:function(){if(!this._bOpen)throw Error("The camera is not open.")}},{key:"ifSaveLastUsedCamera",get:function(){return this._ifSaveLastUsedCamera},set:function(t){t?e.isStorageAvailable("localStorage")?this._ifSaveLastUsedCamera=!0:(this._ifSaveLastUsedCamera=!1,console.warn("Local storage is unavailable")):this._ifSaveLastUsedCamera=!1}},{key:"video",get:function(){return this._video}},{key:"setVideoFit",value:function(e){if(e=e.toLowerCase(),!["contain","cover"].includes(e))throw new Error("It is not allowed to set '".concat(e,"'."));if(this.videoFit=e,this._video&&(this._video.style.objectFit=e,!this.singleFrameMode)){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();var t,r=(0,v.Z)(this._arrScanRegionOverlays);try{for(r.s();!(t=r.n()).done;){var n=t.value;n&&this._updateScanRegionOverlay(n)}}catch(i){r.e(i)}finally{r.f()}}}},{key:"getVideoFit",value:function(){return this.videoFit}},{key:"ifShowScanRegionMask",get:function(){return this._bShowScanRegionMask},set:function(e){this._bShowScanRegionMask=e,e?this.showScanRegionMask():this.hideScanRegionMask()}},{key:"showScanRegionMask",value:function(){this._cvsScanRegion&&"none"==this._cvsScanRegion.style.display&&(this._cvsScanRegion.style.display="")}},{key:"hideScanRegionMask",value:function(){this._cvsScanRegion&&(this._cvsScanRegion.style.display="none")}},{key:"ifShowScanRegionLaser",get:function(){return this._bShowScanRegionLaser},set:function(e){this._bShowScanRegionLaser=e,e?this.showScanRegionLaser():this.hideScanRegionLaser()}},{key:"showScanRegionLaser",value:function(){this._divScanLight&&"none"==this._divScanLight.style.display&&(this._divScanLight.style.display="")}},{key:"hideScanRegionLaser",value:function(){this._divScanLight&&(this._divScanLight.style.display="none")}},{key:"_checkValidRegion",value:function(e){return null===e||!!e&&!!(e.hasOwnProperty("regionLeft")&&e.hasOwnProperty("regionTop")&&e.hasOwnProperty("regionRight")&&e.hasOwnProperty("regionBottom")&&e.hasOwnProperty("regionMeasuredByPercentage"))&&!(e.regionLeft<0||e.regionTop<0||e.regionRight<0||e.regionBottom<0)&&(!e.regionMeasuredByPercentage||!(e.regionLeft>100||e.regionTop>100||e.regionRight>100||e.regionBottom>100))}},{key:"scanRegion",set:function(e){if(!this._checkValidRegion(e))throw new Error("The region is invalid.");this._scanRegion=JSON.parse(JSON.stringify(e)),this._updateScanRegionCanvas(),this._updateScanAreaDiv();var t,r=(0,v.Z)(this._arrScanRegionOverlays);try{for(r.s();!(t=r.n()).done;){var n=t.value;n&&this._updateScanRegionOverlay(n)}}catch(i){r.e(i)}finally{r.f()}}},{key:"setScanRegion",value:function(e){this.scanRegion=e}},{key:"getScanRegion",value:function(){return JSON.parse(JSON.stringify(this._scanRegion))}},{key:"addScanRegionOverlayCanvas",value:function(){this._assertOpen();var e=document.createElement("canvas");if(e.className="cvs-scan-region-overlay-"+this._arrScanRegionOverlays.length,this.singleFrameMode&&(e.addEventListener("click",this._clickIptSingleFrameMode),e.style.cursor="pointer",e.setAttribute("title","Take a photo")),this._updateScanRegionOverlay(e),this._arrScanRegionOverlays.length>0){var t=this._arrScanRegionOverlays.length;this._arrScanRegionOverlays[t-1].after(e)}else if(this._cvsScanRegion)this._cvsScanRegion.before(e);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(e);else{if(!this._video)throw new Error("'video' is null.");this._video.after(e)}return this._arrScanRegionOverlays.push(e),e}},{key:"_updateScanRegionOverlay",value:function(e){if(e){var t,r,n;if(this.singleFrameMode)t=this._imgWidth,r=this._imgHeight,n="contain";else{if(!this._video)return;t=this._video.videoWidth,r=this._video.videoHeight,n=this.getVideoFit()}if(t<=0||r<=0)return e.width=0,void(e.height=0);var i=this._getRegionInPixels(t,r,this._scanRegion),a=i.regionRight-i.regionLeft,o=i.regionBottom-i.regionTop;e.width==a&&e.height==o||(e.width=a,e.height=o);var s,c,u,d,h=window.getComputedStyle(this._video),l=parseFloat(h.width),_=parseFloat(h.height),g=l/_,f=t/r,v=1;if("contain"===n)g<f?(s=0,c=(_-r*(v=l/t))/2):(s=(l-t*(v=_/r))/2,c=0),s+=i.regionLeft*v,c+=i.regionTop*v,u=(i.regionRight-i.regionLeft)*v,d=(i.regionBottom-i.regionTop)*v;else if("cover"===n)if(g<f){v=_/r,s=i.regionLeft*v-(t*v-l)/2,s=Math.max(s,0),s=Math.min(s,parseFloat(h.width)),c=i.regionTop*v;var p=i.regionRight*v-(t*v-l)/2;p=Math.max(p,0),u=(p=Math.min(p,parseFloat(h.width)))-s,d=(i.regionBottom-i.regionTop)*v}else{v=l/t,s=i.regionLeft*v,c=i.regionTop*v-(r*v-_)/2,c=Math.max(c,0),c=Math.min(c,parseFloat(h.height));var m=i.regionBottom*v-(r*v-_)/2;m=Math.max(m,0),m=Math.min(m,parseFloat(h.height)),u=(i.regionRight-i.regionLeft)*v,d=m-c}else s=0,c=0,u=0,d=0;e.style.position="absolute",e.style.left=s+"px",e.style.top=c+"px",e.style.width=u+"px",e.style.height=d+"px"}}},{key:"showScanRegionOverlays",value:function(){var e,t=(0,v.Z)(this._arrScanRegionOverlays);try{for(t.s();!(e=t.n()).done;){var r=e.value;r&&"none"==r.style.display&&(r.style.display="")}}catch(n){t.e(n)}finally{t.f()}}},{key:"hideScanRegionOverlays",value:function(){var e,t=(0,v.Z)(this._arrScanRegionOverlays);try{for(t.s();!(e=t.n()).done;){var r=e.value;r&&(r.style.display="none")}}catch(n){t.e(n)}finally{t.f()}}},{key:"setViewDecorator",value:function(e,t){if(e){this._assertOpen();var r=[];if("string"==typeof e?r.push(e):Array.isArray(e)&&(r=JSON.parse(JSON.stringify(e))),!this._cvsViewDecorator)if(this._cvsViewDecorator=document.createElement("canvas"),this._cvsViewDecorator.className="cvs-view-decorator",this.singleFrameMode&&(this._cvsViewDecorator.addEventListener("click",this._clickIptSingleFrameMode),this._cvsViewDecorator.style.cursor="pointer",this._cvsViewDecorator.setAttribute("title","Take a photo")),this._divScanArea)this._divScanArea.after(this._cvsViewDecorator);else if(this._cvsScanRegion)this._cvsScanRegion.after(this._cvsViewDecorator);else if(this._arrScanRegionOverlays&&0!=this._arrScanRegionOverlays.length){var n=this._arrScanRegionOverlays.length;this._arrScanRegionOverlays[n-1].after(this._cvsViewDecorator)}else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(this._cvsViewDecorator);else{if(!this._video)throw new Error("'video' is null.");this._video.after(this._cvsViewDecorator)}this._decoratorArea=JSON.parse(JSON.stringify(t)),this._decoratorType.length=0;var i,a=["rectangle","focus"],o=["crossline","crosshair"],s=!1,c=!1,u=(0,v.Z)(r);try{for(u.s();!(i=u.n()).done;){var d=i.value;d=d.toLowerCase(),a.includes(d)&&!s&&(s=!0,this._decoratorType.push(d)),o.includes(d)&&!c&&(c=!0,!this._decoratorType.includes(d)&&this._decoratorType.push(d))}}catch(h){u.e(h)}finally{u.f()}this._updateViewDecorator()}else this._cvsViewDecorator&&(this._cvsViewDecorator.remove(),this._cvsViewDecorator=null)}},{key:"getViewDecorator",value:function(){return{type:JSON.parse(JSON.stringify(this._decoratorType)),area:JSON.parse(JSON.stringify(this._decoratorArea)),canvas:this._cvsViewDecorator}}},{key:"showViewDecorator",value:function(){this._cvsViewDecorator&&"none"==this._cvsViewDecorator.style.display&&(this._cvsViewDecorator.style.display="")}},{key:"hideViewDecorator",value:function(){this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none")}},{key:"setViewDecoratorLineWidth",value:function(e,t){if("string"!=typeof e)throw new Error("The 'type' should be a string.");if(e=e.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(e))throw new Error("The type of '".concat(e,"' doesn't exist."));if(!this._viewDecoratorInfo[e].hasOwnProperty("lineWidth"))throw new Error("It is not allowed to change the property 'lineWidth' when the decorator type is '".concat(e,"'."));this._viewDecoratorInfo[e].lineWidth=t,this._updateViewDecorator()}},{key:"setViewDecoratorStrokeStyle",value:function(e,t){if("string"!=typeof e)throw new Error("The 'type' should be a string.");if(e=e.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(e))throw new Error("The type of '".concat(e,"' doesn't exist."));if(!this._viewDecoratorInfo[e].hasOwnProperty("strokeStyle"))throw new Error("It is not allowed to change the property 'strokeStyle' when the decorator type is '".concat(e,"'."));this._viewDecoratorInfo[e].strokeStyle=t,this._updateViewDecorator()}},{key:"setViewDecoratorFillStyle",value:function(e,t){if("string"!=typeof e)throw new Error("The 'type' should be a string.");if(e=e.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(e))throw new Error("The type of '".concat(e,"' doesn't exist."));if(!this._viewDecoratorInfo[e].hasOwnProperty("fillStyle"))throw new Error("It is not allowed to change the property 'fillStyle' when the decorator type is '".concat(e,"'."));this._viewDecoratorInfo[e].fillStyle=t,this._updateViewDecorator()}},{key:"setViewDecoratorMaskFillStyle",value:function(e,t){if("string"!=typeof e)throw new Error("The 'type' should be a string.");if(e=e.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(e))throw new Error("The type of '".concat(e,"' doesn't exist."));if(!this._viewDecoratorInfo[e].hasOwnProperty("maskFillStyle"))throw new Error("It is not allowed to change the property 'maskFillStyle' when the decorator type is '".concat(e,"'."));this._viewDecoratorInfo[e].maskFillStyle=t,this._updateViewDecorator()}},{key:"_updateViewDecorator",value:function(){if(this._bOpen&&this._cvsViewDecorator&&this._decoratorArea){var e;if(this.singleFrameMode)e="contain";else{if(!this._video)return;e=this.getVideoFit()}var t=this._cvsViewDecorator;t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.left="0",t.style.top="0",t.style.objectFit=e;var r=this.getVisibleRegion(!0),n=r.regionRight-r.regionLeft,i=r.regionBottom-r.regionTop;t.width==n&&t.height==i||(t.width=n,t.height=i);var a=t.getContext("2d");a.clearRect(0,0,t.width,t.height);var o,s=this._decoratorArea.x/100*n,c=this._decoratorArea.y/100*i,u=this._decoratorArea.width/100*n,d=this._decoratorArea.height/100*i,h=(0,v.Z)(this._decoratorType);try{for(h.s();!(o=h.n()).done;){var l=o.value;if("rectangle"===l){a.fillStyle=this._viewDecoratorInfo.rectangle.maskFillStyle,a.fillRect(0,0,t.width,t.height),a.clearRect(Math.round(s),Math.round(c),Math.round(u),Math.round(d)),a.fillStyle=this._viewDecoratorInfo.rectangle.fillStyle,a.fillRect(Math.round(s),Math.round(c),Math.round(u),Math.round(d)),a.lineWidth=this._viewDecoratorInfo.rectangle.lineWidth,a.strokeStyle=this._viewDecoratorInfo.rectangle.strokeStyle;var _=a.lineWidth/2;a.strokeRect(Math.round(s-_),Math.round(c-_),Math.round(u+a.lineWidth),Math.round(d+a.lineWidth))}if("focus"===l){a.fillStyle=this._viewDecoratorInfo.focus.maskFillStyle,a.fillRect(0,0,t.width,t.height),a.clearRect(Math.round(s),Math.round(c),Math.round(u),Math.round(d)),a.fillStyle=this._viewDecoratorInfo.focus.fillStyle,a.fillRect(Math.round(s),Math.round(c),Math.round(u),Math.round(d)),a.lineWidth=this._viewDecoratorInfo.focus.lineWidth,a.strokeStyle=this._viewDecoratorInfo.focus.strokeStyle;var g=a.lineWidth/2,f=[0,.25,.75,1],p=[0,.25,.75,1];a.beginPath();for(var m=0;m<f.length;m++)if(0==m||3==m)for(var R=0;R<p.length;R+=2)a.moveTo(Math.round(s+f[m]*u),Math.round(c+p[R]*d)),a.lineTo(Math.round(s+f[m]*u),Math.round(c+p[R+1]*d));for(var S=0;S<p.length;S++)if(0==S||3==S)for(var E=0;E<f.length;E+=2)a.moveTo(Math.round(s+f[E]*u-g),Math.round(c+p[S]*d)),a.lineTo(Math.round(s+f[E+1]*u+g),Math.round(c+p[S]*d));a.stroke()}if("crossline"===l&&(a.beginPath(),a.lineWidth=this._viewDecoratorInfo.crossline.lineWidth,a.strokeStyle=this._viewDecoratorInfo.crossline.strokeStyle,a.moveTo(Math.round(s),Math.round(c+d/2)),a.lineTo(Math.round(s+u),Math.round(c+d/2)),a.moveTo(Math.round(s+u/2),Math.round(c)),a.lineTo(Math.round(s+u/2),Math.round(c+d)),a.stroke()),"crosshair"===l){a.beginPath();var y=.05*Math.min(u,d);a.lineWidth=this._viewDecoratorInfo.crosshair.lineWidth,a.strokeStyle=this._viewDecoratorInfo.crosshair.strokeStyle,a.moveTo(Math.round(s+(u-y)/2),Math.round(c+d/2)),a.lineTo(Math.round(s+(u+y)/2),Math.round(c+d/2)),a.moveTo(Math.round(s+u/2),Math.round(c+(d-y)/2)),a.lineTo(Math.round(s+u/2),Math.round(c+(d+y)/2)),a.stroke()}}}catch(I){h.e(I)}finally{h.f()}}}},{key:"getVisibleRegion",value:function(e){var t,r,n,i=this;if(this._assertOpen(),this.singleFrameMode)t=this._imgWidth,r=this._imgHeight,n="contain";else{if(!this._video)return null;t=this._video.videoWidth,r=this._video.videoHeight,n=this.getVideoFit()}var a=function(){var e,a=parseFloat(window.getComputedStyle(i._video).width),o=parseFloat(window.getComputedStyle(i._video).height),s={regionBottom:r,regionRight:t,regionLeft:0,regionTop:0,regionMeasuredByPercentage:!1};return"cover"===n?a/o<t/r?(e=r/o,s.regionLeft=Math.floor((t-e*a)/2),s.regionRight=Math.ceil(t-s.regionLeft),s.regionTop=0,s.regionBottom=r):(e=t/a,s.regionTop=Math.floor((r-e*o)/2),s.regionBottom=Math.ceil(r-s.regionTop),s.regionLeft=0,s.regionRight=t):"none"===n&&(a<t&&o<r?(s.regionLeft=Math.floor((t-a)/2),s.regionRight=Math.ceil(t-s.regionLeft),s.regionTop=Math.floor((r-o)/2),s.regionBottom=Math.ceil(r-s.regionTop)):a<t?(s.regionLeft=Math.floor((t-a)/2),s.regionRight=Math.ceil(t-s.regionLeft),s.regionTop=0,s.regionBottom=r):o<r&&(s.regionTop=Math.floor((r-o)/2),s.regionBottom=Math.ceil(r-s.regionTop),s.regionLeft=0,s.regionRight=t)),s}();return e?a.regionMeasuredByPercentage=!1:(a.regionBottom=Math.ceil(a.regionBottom/r*100),a.regionRight=Math.ceil(a.regionRight/t*100),a.regionLeft=Math.floor(a.regionLeft/t*100),a.regionTop=Math.floor(a.regionTop/r*100),a.regionMeasuredByPercentage=!0),a}},{key:"setScanRegionMaskStyle",value:function(e){e&&(e.fillStyle&&(this.regionMaskFillStyle=e.fillStyle),e.strokeStyle&&(this.regionMaskStrokeStyle=e.strokeStyle),e.lineWidth&&(this.regionMaskLineWidth=e.lineWidth),this._updateScanRegionCanvas())}},{key:"_getRegionInPixels",value:function(e,t,r){if(!(e<=0||t<=0))return r?r.regionMeasuredByPercentage?{regionLeft:Math.round(r.regionLeft/100*e),regionTop:Math.round(r.regionTop/100*t),regionRight:Math.round(r.regionRight/100*e),regionBottom:Math.round(r.regionBottom/100*t),regionMeasuredByPercentage:!1}:JSON.parse(JSON.stringify(r)):{regionLeft:0,regionTop:0,regionRight:e,regionBottom:t,regionMeasuredByPercentage:!1}}},{key:"_updateScanRegionCanvas",value:function(){if(this._bOpen){var e,t,r;if(this.singleFrameMode)e=this._imgWidth,t=this._imgHeight,r="contain";else{if(!this._video)return;e=this._video.videoWidth,t=this._video.videoHeight,r=this.getVideoFit()}if(e<=0||t<=0)this._cvsScanRegion&&(this._cvsScanRegion.width=0,this._cvsScanRegion.height=0);else{var n=this._getRegionInPixels(e,t,this._scanRegion);if(!this._cvsScanRegion)if(this._cvsScanRegion=document.createElement("canvas"),this._cvsScanRegion.className="cvs-scan-region",this.singleFrameMode&&(this._cvsScanRegion.addEventListener("click",this._clickIptSingleFrameMode),this._cvsScanRegion.style.cursor="pointer",this._cvsScanRegion.setAttribute("title","Take a photo")),this._arrScanRegionOverlays&&0!=this._arrScanRegionOverlays.length){var i=this._arrScanRegionOverlays.length;this._arrScanRegionOverlays[i-1].after(this._cvsScanRegion)}else this._cvsSingleFrameMode?this._cvsSingleFrameMode.after(this._cvsScanRegion):this._video.after(this._cvsScanRegion);var a=this._cvsScanRegion;a.style.position="absolute",a.style.width="100%",a.style.height="100%",a.style.left="0",a.style.top="0",a.style.objectFit=r,a.width==e&&a.height==t||(a.width=e,a.height=t);var o=a.getContext("2d");if(o.clearRect(0,0,a.width,a.height),0!=n.regionLeft||n.regionRight!=e||0!=n.regionTop||n.regionBottom!=t){var s=n.regionLeft,c=n.regionTop,u=n.regionRight-n.regionLeft,d=n.regionBottom-n.regionTop;o.fillStyle=this.regionMaskFillStyle,o.fillRect(0,0,a.width,a.height),o.clearRect(Math.round(s),Math.round(c),Math.round(u),Math.round(d)),o.strokeStyle=this.regionMaskStrokeStyle,o.lineWidth=this.regionMaskLineWidth;var h=o.lineWidth/2;o.strokeRect(Math.round(s-h),Math.round(c-h),Math.round(u+o.lineWidth),Math.round(d+o.lineWidth))}}}}},{key:"_updateScanAreaDiv",value:function(){if(this._bOpen){var e,t,r;if(this.singleFrameMode)e=this._imgWidth,t=this._imgHeight,r="contain";else{if(!this._video)return;e=this._video.videoWidth,t=this._video.videoHeight,r=this.getVideoFit()}if(this._divScanArea){if(e<=0||t<=0)return this._divScanArea.style.width="0",void(this._divScanArea.style.height="0");var n,i,a,o,s=this._getRegionInPixels(e,t,this._scanRegion),c=window.getComputedStyle(this._video),u=parseFloat(c.width),d=parseFloat(c.height),h=u/d,l=e/t,_=1;if("contain"===r)h<l?(n=0,i=(d-t*(_=u/e))/2):(n=(u-e*(_=d/t))/2,i=0),n+=s.regionLeft*_,i+=s.regionTop*_,a=(s.regionRight-s.regionLeft)*_,o=(s.regionBottom-s.regionTop)*_;else if("cover"===r)if(h<l){_=d/t,n=s.regionLeft*_-(e*_-u)/2,n=Math.max(n,0),n=Math.min(n,parseFloat(c.width)),i=s.regionTop*_;var g=s.regionRight*_-(e*_-u)/2;g=Math.max(g,0),a=(g=Math.min(g,parseFloat(c.width)))-n,o=(s.regionBottom-s.regionTop)*_}else{_=u/e,n=s.regionLeft*_,i=s.regionTop*_-(t*_-d)/2,i=Math.max(i,0),i=Math.min(i,parseFloat(c.height));var f=s.regionBottom*_-(t*_-d)/2;f=Math.max(f,0),f=Math.min(f,parseFloat(c.height)),a=(s.regionRight-s.regionLeft)*_,o=f-i}else n=0,i=0,a=0,o=0;this._divScanArea.style.left=n+"px",this._divScanArea.style.top=i+"px",this._divScanArea.style.width=a+"px",this._divScanArea.style.height=o+"px"}}}},{key:"croppingRegions",get:function(){return void 0!==this._croppingRegions?this._croppingRegions:this.referenceConfigurationArray&&1===this.referenceConfigurationArray.length&&this.referenceConfigurationArray[0].hasOwnProperty("croppingRegions")?this.referenceConfigurationArray[0].croppingRegions:this._defaultCroppingRegions},set:function(e){this._croppingRegions=e,this._bFetchingLoopStarted&&(this.bIncreaseRegionIndexAuto&&(this._croppingRegionIndex=0),this._fetchingLoop(!1))}},{key:"croppingRegionIndex",get:function(){return this._croppingRegionIndex},set:function(e){e<0?(this.bIncreaseRegionIndexAuto=!0,this._croppingRegionIndex=0):(this.bIncreaseRegionIndexAuto=!1,this._croppingRegionIndex=e)}},{key:"loopInterval",get:function(){return void 0!==this._loopInterval?this._loopInterval:this.referenceConfigurationArray&&1===this.referenceConfigurationArray.length&&this.referenceConfigurationArray[0].hasOwnProperty("loopInterval")?this.referenceConfigurationArray[0].loopInterval:this._defaultLoopInterval},set:function(e){if(e<0)throw new Error("'loopInterval' should be greater than or equal to 0.");this._loopInterval=e,this._bFetchingLoopStarted&&this._fetchingLoop(!1)}},{key:"maxNumberOfFramesInBuffer",get:function(){return void 0!==this._maxNumberOfFramesInBuffer?this._maxNumberOfFramesInBuffer:this.referenceConfigurationArray&&1===this.referenceConfigurationArray.length&&this.referenceConfigurationArray[0].hasOwnProperty("maxNumberOfFramesInBuffer")?this.referenceConfigurationArray[0].maxNumberOfFramesInBuffer:this._defaultMaxNumberOfFramesInBuffer},set:function(e){if(e<=0)throw new Error("The 'maxNumberOfFramesInBuffer' should be greater than 0.");for(this._maxNumberOfFramesInBuffer=e;this._frameQueue&&this._frameQueue.length>this.maxNumberOfFramesInBuffer;)this._frameQueue.shift()}},{key:"numberOfFramesInBuffer",get:function(){return this._frameQueue.length}},{key:"refreshInterval",get:function(){return void 0!==this._refreshInterval?this._refreshInterval:this.referenceConfigurationArray&&1===this.referenceConfigurationArray.length&&this.referenceConfigurationArray[0].hasOwnProperty("refreshInterval")?this.referenceConfigurationArray[0].refreshInterval:this._defaultRefreshInterval},set:function(e){this._refreshInterval=e}},{key:"isContextDestroyed",value:function(){return this.bDestroyed}},{key:"play",value:function(t,r,n){return p(this,void 0,void 0,u().mark((function i(){var a,o,s,c,d,h,l,_,g,f=this;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(!this._video||!this.videoSrc){i.next=8;break}return i.next=3,new Promise((function(e,t){f._video.onloadedmetadata=function(){return p(f,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=this._video,!t.t0){t.next=6;break}return this._video.onloadedmetadata=null,t.next=5,this._video.play();case 5:e();case 6:case"end":return t.stop()}}),t,this)})))},"string"==typeof f.videoSrc||f.videoSrc instanceof String?f._video.src=f.videoSrc:f._video.srcObject=f.videoSrc,setTimeout((function(){return t(new Error("Failed to play video. Timeout."))}),4e3)}));case 3:a={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId},o=this.mapCameraEvents.get("played"),s=(0,v.Z)(o);try{for(d=function(){var e=c.value,t=JSON.parse(JSON.stringify(a));setTimeout((function(){return e(t)}),0)},s.s();!(c=s.n()).done;)d()}catch(m){s.e(m)}finally{s.f()}return i.abrupt("return",a);case 8:if(!this.singleFrameMode){i.next=10;break}return i.abrupt("return",(this._clickIptSingleFrameMode(),{width:0,height:0,deviceId:null}));case 10:if(this._video){i.next=12;break}return i.abrupt("return",null);case 12:if(h=++this.iPlayRound,l=null,_=0,g=0,this._currentCamera&&(l=this._currentCamera.deviceId),this._video&&(_=this._video.videoWidth,g=this._video.videoHeight),i.t0=this.promisePlay,!i.t0){i.next=21;break}return i.next=20,this.promisePlay;case 20:i.t0=h<this.iPlayRound;case 21:if(!i.t0){i.next=23;break}return i.abrupt("return",{width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId});case 23:return this.promisePlay=p(f,void 0,void 0,u().mark((function i(){var a,o,s,c,d,h,f,R,S,E,y,I,b,A,w,T,D,k,C,M,L,x,O,F,N,B,P,V,U,G,W,H,Z,J,K,Y,Q=this;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.prev=0,o=function(t){return p(this,void 0,void 0,u().mark((function r(){var n,i,a;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=(0,v.Z)(b),r.prev=1,a=u().mark((function r(){var n,a;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=i.value,s(),r.t0=n,!r.t0){r.next=6;break}return r.next=6,new Promise((function(e){return setTimeout(e,n)}));case 6:return s(),a=t.video.deviceId,w=a?a.exact||a.ideal||a:null,r.prev=9,e._onLog&&e._onLog("DCE: ask "+JSON.stringify(t)),r.next=13,navigator.mediaDevices.getUserMedia(t);case 13:return y=r.sent,s(),r.abrupt("return","break");case 18:r.prev=18,r.t1=r.catch(9),A=r.t1,e._onLog&&e._onLog("DCE: "+r.t1.message||0);case 21:case"end":return r.stop()}}),r,null,[[9,18]])})),n.s();case 4:if((i=n.n()).done){r.next=11;break}return r.delegateYield(a(),"t0",6);case 6:if("break"!==r.t0){r.next=9;break}return r.abrupt("break",11);case 9:r.next=4;break;case 11:r.next=16;break;case 13:r.prev=13,r.t1=r.catch(1),n.e(r.t1);case 16:return r.prev=16,n.f(),r.finish(16);case 19:case"end":return r.stop()}}),r,null,[[1,13,16,19]])})))},this._video&&this._video.srcObject&&this.stop(),e._onLog&&e._onLog("DCE: ======before video========"),s=function(){if(!Q._video)throw y&&y.getTracks().forEach((function(e){e.stop()})),Q._videoTrack=null,Q._currentCamera=null,new Error("'video' is null.")},"boolean"==typeof(c=this.getVideoSettings()).video&&(c.video={}),h=["rear","back","r\xfcck","arri\xe8re","trasera","tr\xe1s","traseira","posteriore","\u540e\u9762","\u5f8c\u9762","\u80cc\u9762","\u540e\u7f6e","\u5f8c\u7f6e","\u80cc\u7f6e","\u0437\u0430\u0434\u043d\u0435\u0439","\u0627\u0644\u062e\u0644\u0641\u064a\u0629","\ud6c4","arka","achterzijde","\u0e2b\u0e25\u0e31\u0e07","baksidan","bagside","sau","bak","tylny","takakamera","belakang","\u05d0\u05d7\u05d5\u05e8\u05d9\u05ea","\u03c0\u03af\u03c3\u03c9","spate","h\xe1ts\xf3","zadn\xed","darrere","zadn\xe1","\u0437\u0430\u0434\u043d\u044f","stra\u017enja","belakang","\u092c\u0948\u0915"],f=function(){var t,r=(0,v.Z)(Q._allCameras);try{var n=function(){var e=t.value,r=e.label.toLowerCase();if(r&&h.some((function(e){return-1!=r.indexOf(e)}))&&/\b0(\b)?/.test(r))return delete c.video.facingMode,c.video.deviceId={ideal:e.deviceId},"break"};for(r.s();!(t=r.n()).done&&"break"!==n(););}catch(m){r.e(m)}finally{r.f()}c.video.deviceId||-1==["Android","HarmonyOS"].indexOf(e.browserInfo.OS)||(delete c.video.facingMode,c.video.deviceId={ideal:Q._allCameras[Q._allCameras.length-1].deviceId})},!t){i.next=10;break}delete c.video.facingMode,c.video.deviceId={exact:t},i.next=35;break;case 10:if(!c.video.deviceId){i.next=14;break}i.next=35;break;case 14:if(!this._lastDeviceId){i.next=18;break}delete c.video.facingMode,c.video.deviceId={exact:this._lastDeviceId},i.next=35;break;case 18:if(!(this.ifSaveLastUsedCamera&&e.isStorageAvailable&&window.localStorage.getItem("dce_last_camera_id"))){i.next=24;break}delete c.video.facingMode,c.video.deviceId={exact:window.localStorage.getItem("dce_last_camera_id")},R=JSON.parse(window.localStorage.getItem("dce_last_apply_width")),S=JSON.parse(window.localStorage.getItem("dce_last_apply_height")),R&&S&&(c.video.width=R,c.video.height=S),i.next=35;break;case 24:if(!this.ifSkipCameraInspection){i.next=28;break}i.next=35;break;case 28:if(!c.video.facingMode){i.next=35;break}return i.next=31,this.getAllCameras();case 31:if(this._video){i.next=33;break}return i.abrupt("return",null);case 33:(E=c.video.facingMode)instanceof Array&&E.length&&(E=E[0]),"environment"===(E=E.exact||E.ideal||E)&&(d=!!c.video.facingMode,f());case 35:return r&&(c.video.width={ideal:r}),n&&(c.video.height={ideal:n}),e._onLog&&e._onLog("DCE: ======try getUserMedia========"),b=[0,500],A=null,w=null,i.next=39,o(c);case 39:if(y){i.next=44;break}return e._onLog&&e._onLog("DCE: ======try getUserMedia again========"),"object"==typeof(I=JSON.parse(JSON.stringify(c))).video&&("iPhone"==e.browserInfo.OS?(r>=1280||n>=1280?I.video.width=1280:r>=640||n>=640?I.video.width=640:(r<640||n<640)&&(I.video.width=320),delete I.video.height):d&&!c.video.deviceId?(delete I.video.facingMode,this._allCameras.length&&(I.video.deviceId={ideal:this._allCameras[this._allCameras.length-1].deviceId})):I.video=!0),e._onLog&&e._onLog("DCE: "+I),i.next=44,o(I);case 44:if(i.t0=y,i.t0){i.next=49;break}return b=[1e3,2e3],i.next=49,o(c);case 49:if(i.t1=y,i.t1){i.next=53;break}return i.next=53,o(I);case 53:if(y){i.next=55;break}throw A;case 55:return T=function(){var e,t,r=y.getVideoTracks();if(r.length&&(e=Q._videoTrack=r[0]),Q._video&&e){var n=e.getSettings();if(n){var i,a=(0,v.Z)(Q._allCameras);try{for(a.s();!(i=a.n()).done;){var o=i.value;if(n.deviceId===o.deviceId){o._checked=!0,o.label=e.label,t=o;break}}}catch(m){a.e(m)}finally{a.f()}}if(!t&&w){var s,c=(0,v.Z)(Q._allCameras);try{for(c.s();!(s=c.n()).done;){var u=s.value;if(w==u.deviceId){e.label&&(u._checked=!0,u.label=e.label),t=u;break}}}catch(m){c.e(m)}finally{c.f()}}}Q._currentCamera=t},i.next=58,this.getAllCameras();case 58:if(s(),!d){i.next=70;break}if(T(),f(),(D=c.video.deviceId)&&(D=D.exact||D.ideal||D),k=null===(a=this._currentCamera)||void 0===a?void 0:a.deviceId,i.t2=!D||k&&D==k,i.t2){i.next=70;break}return y.getTracks().forEach((function(e){e.stop()})),b=[0,500,1e3,2e3],i.next=70,o(c);case 70:return s(),C=function(){return p(Q,void 0,void 0,u().mark((function t(){var r=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e._onLog&&e._onLog("======play video========"),t.next=3,new Promise((function(e,t){s(),r._video.onloadedmetadata=function(){return p(r,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return s(),this._video.onloadedmetadata=null,t.next=4,this._video.play();case 4:e();case 5:case"end":return t.stop()}}),t,this)})))},r._video.srcObject=y,setTimeout((function(){return t(new Error("Failed to play video. Timeout."))}),4e3)}));case 3:case"end":return t.stop()}}),t)})))},i.next=74,C();case 74:s(),e._onLog&&e._onLog("DCE: ======played video========"),this._bgLoading&&(this._bgLoading.style.animationPlayState="paused"),M=this._video.videoWidth+"x"+this._video.videoHeight,this._optGotRsl&&(this._optGotRsl.setAttribute("data-width",this._video.videoWidth),this._optGotRsl.setAttribute("data-height",this._video.videoHeight),this._optGotRsl.innerText=M,this._selRsl&&this._optGotRsl.parentNode==this._selRsl&&(this._selRsl.value="got")),e._onLog&&e._onLog("DCE: got "+M),T(),s(),this._renderSelCameraInfo(),(L={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId}).deviceId&&(this._lastDeviceId=L.deviceId,this.ifSaveLastUsedCamera&&e.isStorageAvailable&&(window.localStorage.setItem("dce_last_camera_id",this._lastDeviceId),c.video.width&&c.video.height&&(window.localStorage.setItem("dce_last_apply_width",JSON.stringify(c.video.width)),window.localStorage.setItem("dce_last_apply_height",JSON.stringify(c.video.height))))),x=this.mapCameraEvents.get("played"),O=(0,v.Z)(x);try{for(N=function(){var e=F.value,t=JSON.parse(JSON.stringify(L));setTimeout((function(){return e(t)}),0)},O.s();!(F=O.n()).done;)N()}catch(m){O.e(m)}finally{O.f()}if(l&&l!=L.deviceId){B=this.mapCameraEvents.get("cameraChange"),P=(0,v.Z)(B);try{for(U=function(){var e=V.value,t=JSON.parse(JSON.stringify(L));setTimeout((function(){return e(t)}),0)},P.s();!(V=P.n()).done;)U()}catch(m){P.e(m)}finally{P.f()}}if(_&&g&&(_!=L.width||g!=L.height)){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator(),G=(0,v.Z)(this._arrScanRegionOverlays);try{for(G.s();!(W=G.n()).done;)(H=W.value)&&this._updateScanRegionOverlay(H)}catch(m){G.e(m)}finally{G.f()}Z=this.mapCameraEvents.get("resolutionChange"),J=(0,v.Z)(Z);try{for(Y=function(){var e=K.value,t=JSON.parse(JSON.stringify(L));setTimeout((function(){return e(t)}),0)},J.s();!(K=J.n()).done;)Y()}catch(m){J.e(m)}finally{J.f()}}return i.abrupt("return",(this.promisePlay=null,L));case 89:throw i.prev=89,i.t3=i.catch(0),this.promisePlay=null,i.t3;case 92:case"end":return i.stop()}}),i,this,[[0,89]])}))),i.next=26,this.promisePlay;case 26:return i.abrupt("return",i.sent);case 27:case"end":return i.stop()}}),i,this)})))}},{key:"resume",value:function(){return p(this,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._assertOpen(),e.next=3,this.play();case 3:this._bStoppedByPause&&(this._bStoppedByPause=!1,this.startFetchingLoop()),this._bShowScanRegionLaser&&this.showScanRegionLaser();case 5:case"end":return e.stop()}}),e,this)})))}},{key:"pause",value:function(){this._bOpen||console.warn("The camera is not open."),this._video&&this._video.pause(),this._bFetchingLoopStarted&&(this.stopFetchingLoop(),this._bStoppedByPause=!0),this._bShowScanRegionLaser&&this.hideScanRegionLaser()}},{key:"close",value:function(e){if(this._video){this.stop(),this._unbindUI(),e&&(this.UIElement.style.display="none"),this.stopFetchingLoop(),this.bOpen=!1;var t,r=this.mapCameraEvents.get("cameraClose"),n=(0,v.Z)(r);try{var i=function(){var e=t.value,r={width:0,height:0,deviceId:null};setTimeout((function(){return e(r)}),0)};for(n.s();!(t=n.n()).done;)i()}catch(a){n.e(a)}finally{n.f()}}}},{key:"open",value:function(e){return p(this,void 0,void 0,u().mark((function t(){var r,n,i,a,o;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._bindUI(),e&&(this.UIElement.parentNode||(this.UIElement.style.position="fixed",this.UIElement.style.left="0",this.UIElement.style.top="0",document.body.append(this.UIElement)),"none"==this.UIElement.style.display&&(this.UIElement.style.display="")),t.next=3,this.play();case 3:r=t.sent,this.bOpen=!0,n=this.mapCameraEvents.get("cameraOpen"),i=(0,v.Z)(n);try{for(o=function(){var e=a.value,t=JSON.parse(JSON.stringify(r));setTimeout((function(){return e(t)}),0)},i.s();!(a=i.n()).done;)o()}catch(s){i.e(s)}finally{i.f()}return t.abrupt("return",r);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"stop",value:function(){this._video&&this._video.srcObject&&(e._onLog&&e._onLog("DCE: ======stop video========"),this._video.srcObject.getTracks().forEach((function(e){e.stop()})),this._video.srcObject=null,this._videoTrack=null,this._currentCamera=null),this._video&&this.videoSrc&&(e._onLog&&e._onLog("DCE: ======stop existing video========"),this._video.pause(),this._video.currentTime=0),this._bgLoading&&(this._bgLoading.style.animationPlayState=""),this._frameQueue.length=0}},{key:"getAllCameras",value:function(){return p(this,void 0,void 0,u().mark((function t(){var r,n,i,a,o,s,c,d,h,l,_,g,f;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.enumerateDevices();case 2:if((r=t.sent)[0].deviceId){t.next=12;break}return t.next=6,navigator.mediaDevices.getUserMedia({video:!0});case 6:return n=t.sent,t.next=9,navigator.mediaDevices.enumerateDevices();case 9:r=t.sent,n.getTracks().forEach((function(e){e.stop()})),n=null;case 12:if(i=[],a=[],this._allCameras){o=(0,v.Z)(this._allCameras);try{for(o.s();!(s=o.n()).done;)(c=s.value)._checked&&a.push(c)}catch(u){o.e(u)}finally{o.f()}}for(d=0;d<r.length;d++)if(h=void 0,"videoinput"==(l=r[d]).kind){_=(0,v.Z)(a);try{for(_.s();!(g=_.n()).done;)f=g.value,l.deviceId==f.deviceId&&(h=f)}catch(u){_.e(u)}finally{_.f()}h||((h={}).deviceId=l.deviceId,h.label=l.label?l.label:"camera "+d),i.push(h)}return t.abrupt("return",(this._allCameras=i,e._onLog&&e._onLog("DCE: "+JSON.stringify(this._allCameras)),Promise.resolve(i)));case 16:case"end":return t.stop()}}),t,this)})))}},{key:"_renderSelCameraInfo",value:function(){if(this._selCam&&(this._selCam.innerHTML=""),this._selCam){var e,t,r=(0,v.Z)(this._allCameras);try{for(r.s();!(t=r.n()).done;){var n=t.value,i=document.createElement("option");i.value=n.deviceId,i.innerText=n.label,this._selCam.append(i),n.deviceId&&this._currentCamera&&this._currentCamera.deviceId==n.deviceId&&(e=i)}}catch(a){r.e(a)}finally{r.f()}this._selCam.value=e?e.value:""}}},{key:"getSelectedCamera",value:function(){if(!this._bOpen){var e="",t=this.videoSettings.video.deviceId;t&&(e=t.exact||t.ideal||t);var r,n=(0,v.Z)(this._allCameras);try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i.deviceId===e)return JSON.parse(JSON.stringify(i))}}catch(a){n.e(a)}finally{n.f()}return{deviceId:e,label:"",_checked:!1}}return this._currentCamera}},{key:"selectCamera",value:function(e){return p(this,void 0,void 0,u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r="",e&&(r=e.deviceId||e),this.videoSettings.video.deviceId={exact:r},this._bOpen){t.next=3;break}return t.abrupt("return",null);case 3:return t.next=5,this.play(e.deviceId||e);case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"getResolution",value:function(){if(this._bOpen)return[this._video.videoWidth,this._video.videoHeight];var e=0,t=0,r=this.videoSettings.video.width,n=this.videoSettings.video.height;return r&&(e=r.exact||r.ideal||r),n&&(t=n.exact||n.ideal||n),[e,t]}},{key:"setResolution",value:function(e,t){return p(this,void 0,void 0,u().mark((function r(){var n,i;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e instanceof Array?(n=e[0],i=e[1]):(n=e,i=t),this.videoSettings.video.width={ideal:n},this.videoSettings.video.height={ideal:i},this._bOpen){r.next=2;break}return r.abrupt("return",null);case 2:return r.next=4,this.play(null,n,i);case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),r,this)})))}},{key:"getResolutions",value:function(e){return p(this,void 0,void 0,u().mark((function t(){var r,n,i,a,o,s,c,d,h,l,_,g,f,m,R,S,E=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r="",n=function(e,t){var r=E.mapCameraResolutions.get(e);if(!r||!r.length)return!1;var n,i=(0,v.Z)(r);try{for(i.s();!(n=i.n()).done;){var a=n.value;if(a[0]===t.width&&a[1]===t.height)return!0}}catch(o){i.e(o)}finally{i.f()}return!1},i=function(e,t,r){return p(E,void 0,void 0,u().mark((function n(){var i,a,o,s,c,d;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i={video:{deviceId:{exact:e},width:{ideal:t},height:{ideal:r}}},a=null,n.prev=2,n.next=5,navigator.mediaDevices.getUserMedia(i);case 5:a=n.sent,n.next=11;break;case 8:return n.prev=8,n.t0=n.catch(2),n.abrupt("return",null);case 11:if(a){n.next=13;break}return n.abrupt("return",null);case 13:o=a.getVideoTracks(),s=null;try{c=o[0].getSettings(),s={width:c.width,height:c.height}}catch(i){(d=document.createElement("video")).srcObject=a,s={width:d.videoWidth,height:d.videoHeight},d.srcObject=null}return n.abrupt("return",(o.forEach((function(e){e.stop()})),s));case 17:case"end":return n.stop()}}),n,null,[[2,8]])})))},this._bOpen){t.next=32;break}if(a=this.videoSettings.video.deviceId){t.next=6;break}return t.abrupt("return",null);case 6:if(r=a.hasOwnProperty("exact")?this.videoSettings.video.deviceId.exact:a.hasOwnProperty("ideal")?this.videoSettings.video.deviceId.ideal:this.videoSettings.video.deviceId){t.next=8;break}return t.abrupt("return",null);case 8:if(!(o=this.mapCameraResolutions.get(r))||e){t.next=11;break}return t.abrupt("return",this.mapCameraResolutions.get(r));case 11:this.mapCameraResolutions.set(r,[]),o=this.mapCameraResolutions.get(r),s=(0,v.Z)(this.predefinedResolutions),t.prev=13,s.s();case 15:if((c=s.n()).done){t.next=23;break}return d=c.value,t.next=19,i(r,d.width,d.height);case 19:(h=t.sent)&&!n(r,h)&&o.push([h.width,h.height]);case 21:t.next=15;break;case 23:t.next=28;break;case 25:t.prev=25,t.t0=t.catch(13),s.e(t.t0);case 28:return t.prev=28,s.f(),t.finish(28);case 31:return t.abrupt("return",o);case 32:if(!this._currentCamera){t.next=61;break}if(r=this._currentCamera.deviceId,!(l=this.mapCameraResolutions.get(r))||e){t.next=37;break}return t.abrupt("return",this.mapCameraResolutions.get(r));case 37:this.mapCameraResolutions.set(r,[]),l=this.mapCameraResolutions.get(r),_=this.getConstraints(),g=(0,v.Z)(this.predefinedResolutions),t.prev=40,g.s();case 42:if((f=g.n()).done){t.next=50;break}return m=f.value,t.next=46,this._videoTrack.applyConstraints({width:{ideal:m.width},height:{ideal:m.height}});case 46:R=this._videoTrack.getSettings(),S={width:R.width,height:R.height},n(r,S)||l.push([S.width,S.height]);case 48:t.next=42;break;case 50:t.next=55;break;case 52:t.prev=52,t.t1=t.catch(40),g.e(t.t1);case 55:return t.prev=55,g.f(),t.finish(55);case 58:return t.next=60,this._videoTrack.applyConstraints(_);case 60:return t.abrupt("return",l);case 61:return t.abrupt("return",null);case 62:case"end":return t.stop()}}),t,this,[[13,25,28,31],[40,52,55,58]])})))}},{key:"on",value:function(e,t){if(!this.mapCameraEvents.has(e))throw new Error("Event '".concat(e,"' is not exists."));var r=this.mapCameraEvents.get(e);r.includes(t)||r.push(t)}},{key:"off",value:function(e,t){if(!this.mapCameraEvents.has(e))throw new Error("Event '".concat(e,"' is not exists."));var r=this.mapCameraEvents.get(e),n=r.indexOf(t);-1!==n&&r.splice(n,1)}},{key:"getVideoSettings",value:function(){return JSON.parse(JSON.stringify(this.videoSettings))}},{key:"updateVideoSettings",value:function(e){return this.videoSettings=JSON.parse(JSON.stringify(e)),this._lastDeviceId=null,this._bOpen?this.play():Promise.resolve()}},{key:"isOpen",value:function(){return this._bOpen}},{key:"getCapabilities",value:function(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'turnOnTorch()' is unavailable in singleFrameMode.");if(!this._videoTrack)throw new Error('"_videoTrack" is null.');return this._videoTrack.getCapabilities?this._videoTrack.getCapabilities():{}}},{key:"getCameraSettings",value:function(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getCameraSettings()' is unavailable in singleFrameMode.");if(!this._videoTrack)throw new Error('"_videoTrack" is null.');return this._videoTrack.getSettings()}},{key:"getConstraints",value:function(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getConstraints()' is unavailable in singleFrameMode.");if(!this._videoTrack)throw new Error('"_videoTrack" is null.');return this._videoTrack.getConstraints()}},{key:"applyConstraints",value:function(e){return p(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertOpen(),!this.singleFrameMode){t.next=2;break}throw new Error("'applyConstraints()' is unavailable in singleFrameMode.");case 2:if(this._videoTrack){t.next=4;break}throw new Error('"_videoTrack" is null.');case 4:if(this._videoTrack.applyConstraints){t.next=6;break}throw Error("Not supported.");case 6:return t.next=8,this._videoTrack.applyConstraints(e);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"turnOnTorch",value:function(){return p(this,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertOpen(),!this.singleFrameMode){e.next=2;break}throw new Error("'turnOnTorch()' is unavailable in singleFrameMode.");case 2:if(!this.getCapabilities().torch){e.next=6;break}return e.next=5,this._videoTrack.applyConstraints({advanced:[{torch:!0}]});case 5:return e.abrupt("return",e.sent);case 6:throw Error("Not supported.");case 7:case"end":return e.stop()}}),e,this)})))}},{key:"turnOffTorch",value:function(){return p(this,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._assertOpen(),!this.singleFrameMode){e.next=2;break}throw new Error("'turnOffTorch()' is unavailable in singleFrameMode.");case 2:if(!this.getCapabilities().torch){e.next=6;break}return e.next=5,this._videoTrack.applyConstraints({advanced:[{torch:!1}]});case 5:return e.abrupt("return",e.sent);case 6:throw Error("Not supported.");case 7:case"end":return e.stop()}}),e,this)})))}},{key:"setColorTemperature",value:function(e){return p(this,void 0,void 0,u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertOpen(),!this.singleFrameMode){t.next=2;break}throw new Error("'setColorTemperature()' is unavailable in singleFrameMode.");case 2:if(r=this.getCapabilities().colorTemperature){t.next=5;break}throw Error("Not supported.");case 5:return e<r.min?e=r.min:e>r.max&&(e=r.max),t.next=8,this._videoTrack.applyConstraints({advanced:[{colorTemperature:e}]});case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"setExposureCompensation",value:function(e){return p(this,void 0,void 0,u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertOpen(),!this.singleFrameMode){t.next=2;break}throw new Error("'setExposureCompensation()' is unavailable in singleFrameMode.");case 2:if(r=this.getCapabilities().exposureCompensation){t.next=5;break}throw Error("Not supported.");case 5:return e<r.min?e=r.min:e>r.max&&(e=r.max),t.next=8,this._videoTrack.applyConstraints({advanced:[{exposureCompensation:e}]});case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"setZoom",value:function(e){return p(this,void 0,void 0,u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertOpen(),!this.singleFrameMode){t.next=2;break}throw new Error("'setZoom()' is unavailable in singleFrameMode.");case 2:if(r=this.getCapabilities().zoom){t.next=5;break}throw Error("Not supported.");case 5:return e<r.min?e=r.min:e>r.max&&(e=r.max),t.next=8,this._videoTrack.applyConstraints({advanced:[{zoom:e}]});case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"setFrameRate",value:function(e){return p(this,void 0,void 0,u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this._assertOpen(),!this.singleFrameMode){t.next=2;break}throw new Error("'setFrameRate()' is unavailable in singleFrameMode.");case 2:if(r=this.getCapabilities().frameRate){t.next=5;break}throw Error("Not supported.");case 5:return e<r.min?e=r.min:e>r.max&&(e=r.max),t.next=8,this._videoTrack.applyConstraints({width:{ideal:Math.max(this._video.videoWidth,this._video.videoHeight)},frameRate:e});case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"getFrameRate",value:function(){return this.getCameraSettings().frameRate}},{key:"setFocus",value:function(e,t){return p(this,void 0,void 0,u().mark((function r(){var n,i;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(this._assertOpen(),!this.singleFrameMode){r.next=2;break}throw new Error("'setFocus()' is unavailable in singleFrameMode.");case 2:if(n=this.getCapabilities().focusMode,i=this.getCapabilities().focusDistance,n&&n.includes(e)&&i){r.next=5;break}throw Error("Not supported.");case 5:if(!t){r.next=12;break}return t<i.min?t=i.min:t>i.max&&(t=i.max),r.next=9,this._videoTrack.applyConstraints({advanced:[{focusMode:e,focusDistance:t}]});case 9:r.t0=r.sent,r.next=15;break;case 12:return r.next=14,this._videoTrack.applyConstraints({advanced:[{focusMode:e}]});case 14:r.t0=r.sent;case 15:return r.abrupt("return",r.t0);case 16:case"end":return r.stop()}}),r,this)})))}},{key:"getFocus",value:function(){var e=this.getCameraSettings().focusMode;return"continuous"===e?{mode:e}:{mode:e,distance:this.getCameraSettings().focusDistance}}},{key:"getFrameSize",value:function(e,t,r,n){if(!e||!t)return null;var i,a,o,s,c=e,u=t,d={regionLeft:0,regionTop:0,regionRight:c,regionBottom:u,regionMeasuredByPercentage:!1};r?(r.regionMeasuredByPercentage?(d.regionLeft=r.regionLeft*c/100,d.regionTop=r.regionTop*u/100,d.regionRight=r.regionRight*c/100,d.regionBottom=r.regionBottom*u/100):(d.regionLeft=r.regionLeft,d.regionTop=r.regionTop,d.regionRight=r.regionRight,d.regionBottom=r.regionBottom),i=d.regionLeft,a=d.regionTop,c=Math.round(d.regionRight-d.regionLeft),u=Math.round(d.regionBottom-d.regionTop)):(i=0,a=0);var h=Math.max(c,u);if(n&&n>0&&h>n){var l=n/h;c>u?(o=n,s=Math.round(u*l)):(o=Math.round(c*l),s=n)}else o=c,s=u;return o<=0||s<=0?null:{sx:i,sy:a,sWidth:c,sHeight:u,dWidth:o,dHeight:s}}},{key:"getFrame",value:function(){if(this.singleFrameMode)throw Error("'getFrame()' is unavailable in singleFrameMode.");if(this._assertOpen(),this.singleFrameMode)throw new Error("'getFrame()' is unavailable in singleFrameMode.");return this._getVideoFrame(this._scanRegion)}},{key:"_getVideoFrame",value:function(t,r){var n=this;if(this.bDestroyed)throw Error("The 'CameraEnhancer' instance has been destroyed.");if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getVideoFrame()' is unavailable in singleFrameMode.");var i=Date.now();e._onLog&&e._onLog("DCE: _getVideoFrame(region?) START: "+i);var a=this._video.videoWidth,o=this._video.videoHeight;if(0===a||0===o)return null;var s,c,u=this.getFrameSize(a,o,t,this.maxCvsSideLength);if(!u)return null;s=a!==u.sWidth||o!==u.sHeight,c=u.sWidth!==u.dWidth||u.sHeight!==u.dHeight;var d=!(!n._bWebGLSupported||c),h={data:null,region:t?JSON.parse(JSON.stringify(t)):null,sx:u.sx,sy:u.sy,width:u.dWidth,height:u.dHeight,colorMode:null,timeSpent:null,timeStamp:null,isCropped:s,toCanvas:this.toCanvas,_bUseWebGL:null},l=this._getImageData(this._video,a,o,u,r,{targetColorMode:this.frameColorMode,bUseWebGL:d});if(!l)return null;var _=Date.now();return e._onLog&&e._onLog("DCE: _getVideoFrame(region?) END: "+_),h.data=l.data,h.colorMode=l.colorMode,h._bUseWebGL=l._bUseWebGL,h.timeSpent=_-i,h.timeStamp=_,h}},{key:"_getImageData",value:function(t,r,n,i,a,o){if(this.bDestroyed)throw Error("The 'CameraEnhancer' instance has been destroyed.");if(!r||!n)return null;e._onLog&&e._onLog("DCE: _getImageData() START: "+Date.now());var s,c=i.sx,u=i.sy,d=i.sWidth,h=i.sHeight,l=i.dWidth,_=i.dHeight;if(s=o&&o.targetColorMode?o.targetColorMode.toLowerCase():"rgba",o&&o.bUseWebGL){this.videoGlCvs||(this.videoGlCvs=document.createElement("canvas"));var g=this.videoGlCvs;g.width==r&&g.height==n||(g.width=r,g.height=n,this.videoGl&&this.videoGl.viewport(0,0,r,n));var f=this.videoGl||g.getContext("webgl",{antialias:!1})||g.getContext("experimental-webgl",{antialias:!1});if(!f){this.videoGl=null,this._bWebGLSupported=!1;var v=null;return o?(v=JSON.parse(JSON.stringify(o))).bUseWebGL=!1:v={bUseWebGL:!1},this._getImageData(t,r,n,i,a,v)}if(f.enable(f.SCISSOR_TEST),f.scissor(c,u,l,_),!this.videoGl||s!==this.currentFSColorMode){this.videoGl=f;var p,m=function(e,t,r){var n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(alert("An error occurred compiling the shaders: "+e.getShaderInfoLog(n)),e.deleteShader(n),null)};p=["rgba","rbga","grba","gbra","brga","bgra"].includes(s)?s.slice(0,3):"rgb";var R=function(e,t,r){var n=m(e,e.VERTEX_SHADER,t),i=m(e,e.FRAGMENT_SHADER,r),a=e.createProgram();return e.attachShader(a,n),e.attachShader(a,i),e.linkProgram(a),e.getProgramParameter(a,e.LINK_STATUS)?a:(alert("Unable to initialize the shader program: "+e.getProgramInfoLog(a)),null)}(f,"\n                  attribute mediump vec2 aVertexPosition;\n                  varying mediump vec2 vDirection;\n          \n                  void main( void )\n                  {\n                      gl_Position = vec4(aVertexPosition, 1.0, 1.0) * 2.0;\n                      vDirection = aVertexPosition;\n                  }\n                ","\n                    precision mediump float;\n\n                    varying mediump vec2 vDirection;\n                    uniform sampler2D uSampler;\n                    uniform lowp float uColorFactor;\n            \n                    void main(void)\n                    {\n                        vec4 sample = texture2D(uSampler, vec2(vDirection.x * 0.5 + 0.5, vDirection.y * 0.5 + 0.5));\n                        lowp float grey = 0.21 * sample.r + 0.71 * sample.g + 0.07 * sample.b;\n                        gl_FragColor = vec4(sample.".concat(p," * (1.0 - uColorFactor) + (grey * uColorFactor), sample.a);\n                    }\n                "));this.webglProgramInfo={program:R,attribLocations:{vertexPosition:f.getAttribLocation(R,"aVertexPosition")},uniformLocations:{uSampler:f.getUniformLocation(R,"uSampler"),uColorFactor:f.getUniformLocation(R,"uColorFactor")}},this.webglBuffers=function(e){var t=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,t),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.STATIC_DRAW);var r=e.createBuffer();return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r),e.bufferData(e.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),e.STATIC_DRAW),{position:t,indices:r}}(f),this.webglTexture=function(e){var t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),t}(f),this.currentFSColorMode=s}var S;if(function(e,t,r){var n=e.RGBA,i=e.RGBA,a=e.UNSIGNED_BYTE;e.bindTexture(e.TEXTURE_2D,t),e.texImage2D(e.TEXTURE_2D,0,n,i,a,r)}(f,this.webglTexture,t),function(e,t,r,n){e.clearColor(0,0,0,1),e.clearDepth(1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r.indices),e.useProgram(t.program);var i=e.FLOAT;e.bindBuffer(e.ARRAY_BUFFER,r.position),e.vertexAttribPointer(t.attribLocations.vertexPosition,2,i,!1,0,0),e.enableVertexAttribArray(t.attribLocations.vertexPosition),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,n),e.uniform1i(t.uniformLocations.uSampler,0),e.uniform1f(t.uniformLocations.uColorFactor,"grey"===s||"grey32"===s?1:0);var a=e.UNSIGNED_SHORT;e.drawElements(e.TRIANGLES,6,a,0)}(f,this.webglProgramInfo,this.webglBuffers,this.webglTexture),a){if(a.length<l*_*4)return null;S=a}else this.ifReuseArrayBufferView||"grey"===s?(this.glImgData&&this.glImgData.length===l*_*4||(this.glImgData=new Uint8Array(l*_*4)),S=this.glImgData):S=new Uint8Array(l*_*4);if(f.readPixels(c,u,l,_,f.RGBA,f.UNSIGNED_BYTE,S),f.disable(f.SCISSOR_TEST),255!==S[3]){e._onLog&&e._onLog("DCE: WebGL draw frame incorrectly."),this.forceLoseContext(),this._bWebGLSupported=!1;var E=null;return o?(E=JSON.parse(JSON.stringify(o))).bUseWebGL=!1:E={bUseWebGL:!1},this._getImageData(t,r,n,i,a,E)}if("grey"===s){var y=e._onLog?Date.now():0;if(S=new Uint8Array(new Uint32Array(S.buffer)),a){if(a.length<S.length)return null;a.set(S)}e._onLog&&e._onLog("DCE: Extract grey cost: "+(Date.now()-y))}return e._onLog&&e._onLog("DCE: _getImageData END: "+Date.now()),{data:S,colorMode:s,_bUseWebGL:!0}}this.canvas||(this.canvas=document.createElement("canvas"));var I=this.canvas;I.width===l&&I.height===_||(I.width=l,I.height=_),I.ctx2d||(I.ctx2d=I.getContext("2d"));var b=I.ctx2d;b.drawImage(t,c,u,d,h,0,0,l,_);var A=b.getImageData(0,0,I.width,I.height).data;if(["rbga","grba","gbra","brga","bgra"].includes(s)){var w=s.indexOf("r"),T=s.indexOf("g"),D=s.indexOf("b"),k=0;1===w||2===w?k=w:2===T&&(k=T);for(var C=0;C<A.length;C+=4){var M=void 0;k&&(M=A[C+k]),A[C+w]=A[C],A[C+T]=1===k?M:A[C+1],A[C+D]=2===k?M:A[C+2]}}else if("grey"===s||"grey32"===s)for(var L=0;L<A.length;L+=4){var x=.21*A[L]+.71*A[L+1]+.07*A[L+2];A[L]=x,A[L+1]=x,A[L+2]=x}if(A="grey"===s?new Uint8Array(new Uint32Array(A.buffer)):new Uint8Array(A.buffer),a){if(a.length<A.length)return null;a.set(A)}return e._onLog&&e._onLog("DCE: _getVideoFrame(region?) END: "+Date.now()),{data:A,colorMode:s,_bUseWebGL:!1}}},{key:"getCurrentRegion",value:function(){var e=null;if(this._scanRegion)e=this._scanRegion;else if(this.croppingRegions){if(this._croppingRegionIndex>=this.croppingRegions.length||this._croppingRegionIndex<0)throw new Error("The 'croppingRegionIndex' is out of bounds.");e=this.croppingRegions[this._croppingRegionIndex],this.bIncreaseRegionIndexAuto&&++this._croppingRegionIndex>=this.croppingRegions.length&&(this._croppingRegionIndex=0)}return e}},{key:"_fetchingLoop",value:function(t){var r=this;if(this.bDestroyed)this.stopFetchingLoop();else if(this._bOpen&&this.isFetchingLoopStarted()){if(this._video.paused)return e._onLog&&e._onLog("DCE: Video is paused. Ask in 1s."),this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),void(this._frameLoopTimeoutId=setTimeout((function(){r._fetchingLoop(!0)}),1e3));var n=function(){e._onLog&&e._onLog("DCE: start fetching a frame: "+Date.now());var t=r.getCurrentRegion(),n=r._getVideoFrame(t);if(n){for(;r._frameQueue&&r._frameQueue.length>=r.maxNumberOfFramesInBuffer;)r._frameQueue.shift();r._frameQueue.push(n),e._onLog&&e._onLog("DCE: finish fetching a frame: "+Date.now());var i,a=r.mapCameraEvents.get("frameAddedToBuffer"),o=(0,v.Z)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value;setTimeout(s,0)}}catch(c){o.e(c)}finally{o.f()}}else e._onLog&&e._onLog("DCE: get a invalid frame, abandon it: "+Date.now())},i=function t(){r._frameLoopTimeoutId2&&clearTimeout(r._frameLoopTimeoutId2),r.refreshInterval<=0||(r._frameLoopTimeoutId2=setTimeout((function(){r.bDestroyed?r.stopFetchingLoop():r._bOpen&&r.isFetchingLoopStarted()?r._video.paused?r._frameLoopTimeoutId&&clearTimeout(r._frameLoopTimeoutId):(e._onLog&&e._onLog("DCE: second timeout executes: "+Date.now()),n(),t()):r.stopFetchingLoop()}),r.refreshInterval))};t&&(this._frameQueue.length<this.maxNumberOfFramesInBuffer?(n(),this.refreshInterval>0&&i()):this.refreshInterval>0?(n(),i()):0===this.refreshInterval?n():this.refreshInterval),this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),this._frameLoopTimeoutId=setTimeout((function(){r._fetchingLoop(!0)}),this.loopInterval)}else this.stopFetchingLoop()}},{key:"startFetchingLoop",value:function(){if(this.bDestroyed)throw Error("The DCE instance has been destroyed.");if(this._assertOpen(),this.singleFrameMode)throw Error("'startFetchingLoop()' is unavailable in singleFrameMode.");if(this._video.paused)throw Error("The video is paused.");this.isFetchingLoopStarted()||(this._bFetchingLoopStarted=!0,e._onLog&&e._onLog("start fetching loop: "+Date.now()),this._fetchingLoop(!0))}},{key:"isFetchingLoopStarted",value:function(){return this._bFetchingLoopStarted}},{key:"stopFetchingLoop",value:function(){this._bFetchingLoopStarted&&(e._onLog&&e._onLog("stop fetching loop: "+Date.now()),this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),this._frameQueue.length=0,this._bFetchingLoopStarted=!1)}},{key:"getFrameFromBuffer",value:function(e){return this._frameQueue&&this._frameQueue.length?e?e<this._frameQueue.length?(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this._frameQueue.splice(e,1)[0]):void 0:(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this._frameQueue.shift()):null}},{key:"forceLoseContext",value:function(){if(this.videoGl){var e=this.videoGl;e&&!e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").loseContext(),this.webglTexture=null,this.webglProgramInfo=null,this.webglBuffers=null,this.videoGl=null,this.videoGlCvs=null}}},{key:"dispose",value:function(e){this.close(!0),this.forceLoseContext(),this.setViewDecorator(null,null);var t,r=(0,v.Z)(this._arrScanRegionOverlays);try{for(r.s();!(t=r.n()).done;){var n=t.value;n&&n.remove()}}catch(i){r.e(i)}finally{r.f()}e&&this.UIElement&&this.UIElement.remove(),this.__proto__=null}}],[{key:"getVersion",value:function(){return this._version}},{key:"detectEnvironment",value:function(){return p(this,void 0,void 0,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t={wasm:"undefined"!=typeof WebAssembly&&("undefined"==typeof navigator||!(/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&/\(.+\s11_2_([2-6]).*\)/.test(navigator.userAgent))),worker:!("undefined"==typeof Worker),getUserMedia:!("undefined"==typeof navigator||!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),camera:!1,browser:this.browserInfo.browser,version:this.browserInfo.version,OS:this.browserInfo.OS}).getUserMedia){e.next=11;break}return e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia({video:!0});case 5:e.sent.getTracks().forEach((function(e){e.stop()})),t.camera=!0,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this,[[2,9]])})))}},{key:"engineResourcePath",get:function(){return this._engineResourcePath},set:function(t){if(this._hasEngineResourceLoaded)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` is called.");if(null==t&&(t="./"),r)e._engineResourcePath=t;else{var r=document.createElement("a");r.href=t,e._engineResourcePath=r.href}this._engineResourcePath.endsWith("/")||(e._engineResourcePath+="/")}},{key:"isStorageAvailable",value:function(e){var t;try{t=window[e];var r="__storage_test__";return t.setItem(r,r),t.removeItem(r),!0}catch(e){return e instanceof DOMException&&(22===e.code||1014===e.code||"QuotaExceededError"===e.name||"NS_ERROR_DOM_QUOTA_REACHED"===e.name)&&t&&0!==t.length}}},{key:"defaultUIElementURL",get:function(){var t;return null===(t=e._defaultUIElementURL)||void 0===t?void 0:t.replace("@engineResourcePath/",e.engineResourcePath)},set:function(t){e._defaultUIElementURL=t}},{key:"createInstance",value:function(t){return p(this,void 0,void 0,u().mark((function r(){var n,i;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:for(i in n=new e,("string"==typeof t||t instanceof String)&&(t=JSON.parse(t)),t)n[i]=t[i];return r.next=5,n.setUIElement(e.defaultUIElementURL);case 5:return this._hasEngineResourceLoaded=!0,r.abrupt("return",n);case 7:case"end":return r.stop()}}),r,this)})))}}]),e}();function b(e,t,r,n){return new(r||(r=Promise))((function(i,a){function o(e){try{c(n.next(e))}catch(e){a(e)}}function s(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,s)}c((n=n.apply(e,t||[])).next())}))}I._jsVersion="2.3.1",I._jsEditVersion="20220321",I._version="JS "+I._jsVersion+"."+I._jsEditVersion,I.browserInfo=function(){if(!y){var e={init:function(){this.browser=this.searchString(this.dataBrowser)||"unknownBrowser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"unknownVersion",this.OS=this.searchString(this.dataOS)||"unknownOS","Linux"==this.OS&&-1!=navigator.userAgent.indexOf("Windows NT")&&(this.OS="HarmonyOS")},searchString:function(e){for(var t=0;t<e.length;t++){var r=e[t].string,n=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,r){if(-1!=r.indexOf(e[t].subString))return e[t].identity}else if(n)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Edge",identity:"Edge"},{string:navigator.userAgent,subString:"OPR",identity:"OPR"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:navigator.userAgent,subString:"HarmonyOS",identity:"HarmonyOS"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};return e.init(),{browser:e.browser,version:e.version,OS:e.OS}}if(y)return{browser:"ssr",version:0,OS:"ssr"}}(),I._hasEngineResourceLoaded=!1,I._engineResourcePath=function(){if(!t&&document.currentScript){var e=document.currentScript.src,t=e.indexOf("?");if(-1!=t)e=e.substring(0,t);else{var r=e.indexOf("#");-1!=r&&(e=e.substring(0,r))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"}(),I._defaultUIElementURL="@engineResourcePath/dce.ui.html",function(e){e[e.IPF_Binary=0]="IPF_Binary",e[e.IPF_BinaryInverted=1]="IPF_BinaryInverted",e[e.IPF_GrayScaled=2]="IPF_GrayScaled",e[e.IPF_NV21=3]="IPF_NV21",e[e.IPF_RGB_565=4]="IPF_RGB_565",e[e.IPF_RGB_555=5]="IPF_RGB_555",e[e.IPF_RGB_888=6]="IPF_RGB_888",e[e.IPF_ARGB_8888=7]="IPF_ARGB_8888",e[e.IPF_RGB_161616=8]="IPF_RGB_161616",e[e.IPF_ARGB_16161616=9]="IPF_ARGB_16161616",e[e.IPF_ABGR_8888=10]="IPF_ABGR_8888",e[e.IPF_ABGR_16161616=11]="IPF_ABGR_16161616",e[e.IPF_BGR_888=12]="IPF_BGR_888"}(m||(m={})),function(e){e[e.DBR_SYSTEM_EXCEPTION=1]="DBR_SYSTEM_EXCEPTION",e[e.DBR_SUCCESS=0]="DBR_SUCCESS",e[e.DBR_UNKNOWN=-1e4]="DBR_UNKNOWN",e[e.DBR_NO_MEMORY=-10001]="DBR_NO_MEMORY",e[e.DBR_NULL_REFERENCE=-10002]="DBR_NULL_REFERENCE",e[e.DBR_LICENSE_INVALID=-10003]="DBR_LICENSE_INVALID",e[e.DBR_LICENSE_EXPIRED=-10004]="DBR_LICENSE_EXPIRED",e[e.DBR_FILE_NOT_FOUND=-10005]="DBR_FILE_NOT_FOUND",e[e.DBR_FILETYPE_NOT_SUPPORTED=-10006]="DBR_FILETYPE_NOT_SUPPORTED",e[e.DBR_BPP_NOT_SUPPORTED=-10007]="DBR_BPP_NOT_SUPPORTED",e[e.DBR_INDEX_INVALID=-10008]="DBR_INDEX_INVALID",e[e.DBR_BARCODE_FORMAT_INVALID=-10009]="DBR_BARCODE_FORMAT_INVALID",e[e.DBR_CUSTOM_REGION_INVALID=-10010]="DBR_CUSTOM_REGION_INVALID",e[e.DBR_MAX_BARCODE_NUMBER_INVALID=-10011]="DBR_MAX_BARCODE_NUMBER_INVALID",e[e.DBR_IMAGE_READ_FAILED=-10012]="DBR_IMAGE_READ_FAILED",e[e.DBR_TIFF_READ_FAILED=-10013]="DBR_TIFF_READ_FAILED",e[e.DBR_QR_LICENSE_INVALID=-10016]="DBR_QR_LICENSE_INVALID",e[e.DBR_1D_LICENSE_INVALID=-10017]="DBR_1D_LICENSE_INVALID",e[e.DBR_DIB_BUFFER_INVALID=-10018]="DBR_DIB_BUFFER_INVALID",e[e.DBR_PDF417_LICENSE_INVALID=-10019]="DBR_PDF417_LICENSE_INVALID",e[e.DBR_DATAMATRIX_LICENSE_INVALID=-10020]="DBR_DATAMATRIX_LICENSE_INVALID",e[e.DBR_PDF_READ_FAILED=-10021]="DBR_PDF_READ_FAILED",e[e.DBR_PDF_DLL_MISSING=-10022]="DBR_PDF_DLL_MISSING",e[e.DBR_PAGE_NUMBER_INVALID=-10023]="DBR_PAGE_NUMBER_INVALID",e[e.DBR_CUSTOM_SIZE_INVALID=-10024]="DBR_CUSTOM_SIZE_INVALID",e[e.DBR_CUSTOM_MODULESIZE_INVALID=-10025]="DBR_CUSTOM_MODULESIZE_INVALID",e[e.DBR_RECOGNITION_TIMEOUT=-10026]="DBR_RECOGNITION_TIMEOUT",e[e.DBR_JSON_PARSE_FAILED=-10030]="DBR_JSON_PARSE_FAILED",e[e.DBR_JSON_TYPE_INVALID=-10031]="DBR_JSON_TYPE_INVALID",e[e.DBR_JSON_KEY_INVALID=-10032]="DBR_JSON_KEY_INVALID",e[e.DBR_JSON_VALUE_INVALID=-10033]="DBR_JSON_VALUE_INVALID",e[e.DBR_JSON_NAME_KEY_MISSING=-10034]="DBR_JSON_NAME_KEY_MISSING",e[e.DBR_JSON_NAME_VALUE_DUPLICATED=-10035]="DBR_JSON_NAME_VALUE_DUPLICATED",e[e.DBR_TEMPLATE_NAME_INVALID=-10036]="DBR_TEMPLATE_NAME_INVALID",e[e.DBR_JSON_NAME_REFERENCE_INVALID=-10037]="DBR_JSON_NAME_REFERENCE_INVALID",e[e.DBR_PARAMETER_VALUE_INVALID=-10038]="DBR_PARAMETER_VALUE_INVALID",e[e.DBR_DOMAIN_NOT_MATCHED=-10039]="DBR_DOMAIN_NOT_MATCHED",e[e.DBR_RESERVEDINFO_NOT_MATCHED=-10040]="DBR_RESERVEDINFO_NOT_MATCHED",e[e.DBR_AZTEC_LICENSE_INVALID=-10041]="DBR_AZTEC_LICENSE_INVALID",e[e.DBR_LICENSE_DLL_MISSING=-10042]="DBR_LICENSE_DLL_MISSING",e[e.DBR_LICENSEKEY_NOT_MATCHED=-10043]="DBR_LICENSEKEY_NOT_MATCHED",e[e.DBR_REQUESTED_FAILED=-10044]="DBR_REQUESTED_FAILED",e[e.DBR_LICENSE_INIT_FAILED=-10045]="DBR_LICENSE_INIT_FAILED",e[e.DBR_PATCHCODE_LICENSE_INVALID=-10046]="DBR_PATCHCODE_LICENSE_INVALID",e[e.DBR_POSTALCODE_LICENSE_INVALID=-10047]="DBR_POSTALCODE_LICENSE_INVALID",e[e.DBR_DPM_LICENSE_INVALID=-10048]="DBR_DPM_LICENSE_INVALID",e[e.DBR_FRAME_DECODING_THREAD_EXISTS=-10049]="DBR_FRAME_DECODING_THREAD_EXISTS",e[e.DBR_STOP_DECODING_THREAD_FAILED=-10050]="DBR_STOP_DECODING_THREAD_FAILED",e[e.DBR_SET_MODE_ARGUMENT_ERROR=-10051]="DBR_SET_MODE_ARGUMENT_ERROR",e[e.DBR_LICENSE_CONTENT_INVALID=-10052]="DBR_LICENSE_CONTENT_INVALID",e[e.DBR_LICENSE_KEY_INVALID=-10053]="DBR_LICENSE_KEY_INVALID",e[e.DBR_LICENSE_DEVICE_RUNS_OUT=-10054]="DBR_LICENSE_DEVICE_RUNS_OUT",e[e.DBR_GET_MODE_ARGUMENT_ERROR=-10055]="DBR_GET_MODE_ARGUMENT_ERROR",e[e.DBR_IRT_LICENSE_INVALID=-10056]="DBR_IRT_LICENSE_INVALID",e[e.DBR_MAXICODE_LICENSE_INVALID=-10057]="DBR_MAXICODE_LICENSE_INVALID",e[e.DBR_GS1_DATABAR_LICENSE_INVALID=-10058]="DBR_GS1_DATABAR_LICENSE_INVALID",e[e.DBR_GS1_COMPOSITE_LICENSE_INVALID=-10059]="DBR_GS1_COMPOSITE_LICENSE_INVALID",e[e.DBR_DOTCODE_LICENSE_INVALID=-10061]="DBR_DOTCODE_LICENSE_INVALID",e[e.DMERR_NO_LICENSE=-2e4]="DMERR_NO_LICENSE",e[e.DMERR_LICENSE_SYNC_FAILED=-20003]="DMERR_LICENSE_SYNC_FAILED",e[e.DMERR_TRIAL_LICENSE=-20010]="DMERR_TRIAL_LICENSE",e[e.DMERR_FAILED_TO_REACH_LTS=-20200]="DMERR_FAILED_TO_REACH_LTS"}(R||(R={})),function(e){e[e.IMRDT_IMAGE=1]="IMRDT_IMAGE",e[e.IMRDT_CONTOUR=2]="IMRDT_CONTOUR",e[e.IMRDT_LINESEGMENT=4]="IMRDT_LINESEGMENT",e[e.IMRDT_LOCALIZATIONRESULT=8]="IMRDT_LOCALIZATIONRESULT",e[e.IMRDT_REGIONOFINTEREST=16]="IMRDT_REGIONOFINTEREST",e[e.IMRDT_QUADRILATERAL=32]="IMRDT_QUADRILATERAL"}(S||(S={})),function(e){e[e.BF_ALL=4265607167]="BF_ALL",e[e.BF_ONED=3147775]="BF_ONED",e[e.BF_GS1_DATABAR=260096]="BF_GS1_DATABAR",e[e.BF_CODE_39=1]="BF_CODE_39",e[e.BF_CODE_128=2]="BF_CODE_128",e[e.BF_CODE_93=4]="BF_CODE_93",e[e.BF_CODABAR=8]="BF_CODABAR",e[e.BF_ITF=16]="BF_ITF",e[e.BF_EAN_13=32]="BF_EAN_13",e[e.BF_EAN_8=64]="BF_EAN_8",e[e.BF_UPC_A=128]="BF_UPC_A",e[e.BF_UPC_E=256]="BF_UPC_E",e[e.BF_INDUSTRIAL_25=512]="BF_INDUSTRIAL_25",e[e.BF_CODE_39_EXTENDED=1024]="BF_CODE_39_EXTENDED",e[e.BF_GS1_DATABAR_OMNIDIRECTIONAL=2048]="BF_GS1_DATABAR_OMNIDIRECTIONAL",e[e.BF_GS1_DATABAR_TRUNCATED=4096]="BF_GS1_DATABAR_TRUNCATED",e[e.BF_GS1_DATABAR_STACKED=8192]="BF_GS1_DATABAR_STACKED",e[e.BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL=16384]="BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL",e[e.BF_GS1_DATABAR_EXPANDED=32768]="BF_GS1_DATABAR_EXPANDED",e[e.BF_GS1_DATABAR_EXPANDED_STACKED=65536]="BF_GS1_DATABAR_EXPANDED_STACKED",e[e.BF_GS1_DATABAR_LIMITED=131072]="BF_GS1_DATABAR_LIMITED",e[e.BF_PATCHCODE=262144]="BF_PATCHCODE",e[e.BF_PDF417=33554432]="BF_PDF417",e[e.BF_QR_CODE=67108864]="BF_QR_CODE",e[e.BF_DATAMATRIX=134217728]="BF_DATAMATRIX",e[e.BF_AZTEC=268435456]="BF_AZTEC",e[e.BF_MAXICODE=536870912]="BF_MAXICODE",e[e.BF_MICRO_QR=1073741824]="BF_MICRO_QR",e[e.BF_MICRO_PDF417=524288]="BF_MICRO_PDF417",e[e.BF_GS1_COMPOSITE=2147483648]="BF_GS1_COMPOSITE",e[e.BF_MSI_CODE=1048576]="BF_MSI_CODE",e[e.BF_CODE_11=2097152]="BF_CODE_11",e[e.BF_NULL=0]="BF_NULL"}(E||(E={})),"object"==typeof r.g&&r.g.process&&r.g.process.release&&r.g.process.release.name;var A="undefined"==typeof self,w=A?{}:self,T=function(){function e(){(0,i.Z)(this,e),this._canvasMaxWH="iPhone"==e.browserInfo.OS||"Android"==e.browserInfo.OS?2048:4096,this._instanceID=void 0,this._ifSaveOriginalImageInACanvas=!1,this.oriCanvas=null,this.oriCanvasData=null,this.bFilterRegionInJs=!0,this._region=null,this._timeStartDecode=null,this._timeEnterInnerDBR=null,this._timeGetMessage=null,this.decodeRecords={},this.bDestroyed=!1,this._lastErrorCode=0,this._lastErrorString="",this._lastInnerDecodeDuration=0}return(0,a.Z)(e,[{key:"ifSaveOriginalImageInACanvas",get:function(){return this._ifSaveOriginalImageInACanvas},set:function(e){this._ifSaveOriginalImageInACanvas=e}},{key:"getOriginalImageInACanvas",value:function(){return!this.oriCanvas&&this.oriCanvasData?this.oriCanvasData.toCanvas():this.oriCanvas}},{key:"region",get:function(){return this._region},set:function(e){this._region=e}},{key:"isContextDestroyed",value:function(){return this.bDestroyed}},{key:"lastErrorCode",get:function(){return this._lastErrorCode}},{key:"lastErrorString",get:function(){return this._lastErrorString}},{key:"decode",value:function(t){return b(this,void 0,void 0,u().mark((function r(){var n;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e._onLog&&e._onLog("decode(source: any)"),e._onLog&&(this._timeStartDecode=Date.now()),n={},!this.region||this.region instanceof Array||(n.region=JSON.parse(JSON.stringify(this.region))),!(t instanceof Blob)){r.next=9;break}return r.next=6,this._decode_Blob(t,n);case 6:r.t0=r.sent,r.next=68;break;case 9:if(!(t instanceof ArrayBuffer)){r.next=15;break}return r.next=12,this._decode_ArrayBuffer(t,n);case 12:r.t1=r.sent,r.next=67;break;case 15:if(!(t instanceof Uint8Array||t instanceof Uint8ClampedArray)){r.next=21;break}return r.next=18,this._decode_Uint8Array(t,n);case 18:r.t2=r.sent,r.next=66;break;case 21:if(!(t instanceof HTMLImageElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap)){r.next=27;break}return r.next=24,this._decode_Image(t,n);case 24:r.t3=r.sent,r.next=65;break;case 27:if(!(t instanceof HTMLCanvasElement)){r.next=33;break}return r.next=30,this._decode_Canvas(t,n);case 30:r.t4=r.sent,r.next=64;break;case 33:if(!(t instanceof HTMLVideoElement)){r.next=39;break}return r.next=36,this._decode_Video(t,n);case 36:r.t5=r.sent,r.next=63;break;case 39:if("string"!=typeof t){r.next=52;break}if("data:image/"!=t.substring(0,11)){r.next=46;break}return r.next=43,this._decode_Base64(t,n);case 43:r.t7=r.sent,r.next=49;break;case 46:return r.next=48,this._decode_Url(t,n);case 48:r.t7=r.sent;case 49:r.t6=r.t7,r.next=62;break;case 52:if(!t||"object"!=typeof t){r.next=58;break}return r.next=55,this._decode_DCEFrame(t,n);case 55:r.t8=r.sent,r.next=61;break;case 58:return r.next=60,Promise.reject(TypeError("'_decode(source, config)': Type of 'source' should be 'Blob', 'ArrayBuffer', 'Uint8Array', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement', 'String(base64 with image mime)' or 'String(url)'."));case 60:r.t8=r.sent;case 61:r.t6=r.t8;case 62:r.t5=r.t6;case 63:r.t4=r.t5;case 64:r.t3=r.t4;case 65:r.t2=r.t3;case 66:r.t1=r.t2;case 67:r.t0=r.t1;case 68:return r.abrupt("return",r.t0);case 69:case"end":return r.stop()}}),r,this)})))}},{key:"decodeBase64String",value:function(e){return b(this,void 0,void 0,u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={},t.abrupt("return",(!this.region||this.region instanceof Array||(r.region=JSON.parse(JSON.stringify(this.region))),this._decode_Base64(e,r)));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"decodeUrl",value:function(e){return b(this,void 0,void 0,u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={},t.abrupt("return",(!this.region||this.region instanceof Array||(r.region=JSON.parse(JSON.stringify(this.region))),this._decode_Url(e,r)));case 2:case"end":return t.stop()}}),t,this)})))}},{key:"_decodeBuffer_Uint8Array",value:function(t,r,n,i,a,o){return b(this,void 0,void 0,u().mark((function s(){var c=this;return u().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,new Promise((function(s,u){var d=e._nextTaskID++;e._taskCallbackMap.set(d,(function(t){if(t.success){var r,n=e._onLog?Date.now():0;e._onLog&&e._onLog("worker return result: "+n),c._lastInnerDecodeDuration=t.duration;try{r=c._handleRetJsonString(t.decodeReturn)}catch(t){return u(t)}if(e._onLog){var i=Date.now();e._onLog("DBR time get result: "+n),e._onLog("Handle image cost: "+(c._timeEnterInnerDBR-c._timeStartDecode)),e._onLog("DBR worker decode image cost: "+(n-c._timeEnterInnerDBR)),e._onLog("DBR worker handle results: "+(i-n)),e._onLog("Total decode image cost: "+(i-c._timeStartDecode))}return s(r)}var a=new Error(t.message);return a.stack=t.stack+"\n"+a.stack,u(a)})),c._timeEnterInnerDBR=Date.now(),e._onLog&&e._onLog("Send buffer to worker:"+c._timeEnterInnerDBR),e._dbrWorker.postMessage({type:"decodeBuffer",id:d,instanceID:c._instanceID,body:{buffer:t,width:r,height:n,stride:i,format:a,config:o}},[t.buffer]),e._onLog&&o&&o._timeEndGettingFrame&&e._onLog("decode image delay: "+(c._timeEnterInnerDBR-o._timeEndGettingFrame))}));case 2:return s.abrupt("return",s.sent);case 3:case"end":return s.stop()}}),s)})))}},{key:"_decodeBuffer_Blob",value:function(t,r,n,i,a,o){return b(this,void 0,void 0,u().mark((function s(){var c;return u().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(e._onLog&&e._onLog("_decodeBuffer_Blob(buffer,width,height,stride,format)"),!t.arrayBuffer){s.next=7;break}return s.next=4,t.arrayBuffer();case 4:s.t0=s.sent,s.next=10;break;case 7:return s.next=9,new Promise((function(e,r){var n=new FileReader;n.readAsArrayBuffer(t),n.onload=function(){e(n.result)},n.onerror=function(){r(n.error)}}));case 9:s.t0=s.sent;case 10:return c=s.t0,s.next=13,this._decodeBuffer_Uint8Array(new Uint8Array(c),r,n,i,a,o);case 13:return s.abrupt("return",s.sent);case 14:case"end":return s.stop()}}),s,this)})))}},{key:"decodeBuffer",value:function(t,r,n,i,a,o){return b(this,void 0,void 0,u().mark((function s(){var c;return u().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(e._onLog&&e._onLog("decodeBuffer(buffer,width,height,stride,format)"),e._onLog&&(this._timeStartDecode=Date.now()),!(t instanceof Uint8Array||t instanceof Uint8ClampedArray)){s.next=8;break}return s.next=5,this._decodeBuffer_Uint8Array(t,r,n,i,a,o);case 5:c=s.sent,s.next=19;break;case 8:if(!(t instanceof ArrayBuffer)){s.next=14;break}return s.next=11,this._decodeBuffer_Uint8Array(new Uint8Array(t),r,n,i,a,o);case 11:c=s.sent,s.next=19;break;case 14:if(s.t0=t instanceof Blob,!s.t0){s.next=19;break}return s.next=18,this._decodeBuffer_Blob(t,r,n,i,a,o);case 18:c=s.sent;case 19:return s.abrupt("return",c);case 20:case"end":return s.stop()}}),s,this)})))}},{key:"_decodeFileInMemory_Uint8Array",value:function(t){return b(this,void 0,void 0,u().mark((function r(){var n=this;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,new Promise((function(r,i){var a=e._nextTaskID++;e._taskCallbackMap.set(a,(function(e){if(e.success){var t;n._lastInnerDecodeDuration=e.duration;try{t=n._handleRetJsonString(e.decodeReturn)}catch(e){return i(e)}return r(t)}var a=new Error(e.message);return a.stack=e.stack+"\n"+a.stack,i(a)})),e._dbrWorker.postMessage({type:"decodeFileInMemory",id:a,instanceID:n._instanceID,body:{bytes:t}})}));case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)})))}},{key:"getRuntimeSettings",value:function(){return b(this,void 0,void 0,u().mark((function t(){var r=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,n){var i=e._nextTaskID++;e._taskCallbackMap.set(i,(function(e){if(e.success){var i=JSON.parse(e.results);return null!=r.userDefinedRegion&&(i.region=JSON.parse(JSON.stringify(r.userDefinedRegion))),t(i)}var a=new Error(e.message);return a.stack=e.stack+"\n"+a.stack,n(a)})),e._dbrWorker.postMessage({type:"getRuntimeSettings",id:i,instanceID:r._instanceID})}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))}},{key:"updateRuntimeSettings",value:function(t){return b(this,void 0,void 0,u().mark((function r(){var n,i,a,o,s,c,d=this;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("string"!=typeof t){r.next=52;break}if("speed"!=t){r.next=18;break}return r.next=4,this.getRuntimeSettings();case 4:return i=r.sent,r.next=7,this.resetRuntimeSettings();case 7:return r.next=9,this.getRuntimeSettings();case 9:(n=r.sent).barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,n.region=i.region,n.deblurLevel=3,n.expectedBarcodesCount=0,n.localizationModes=[2,0,0,0,0,0,0,0],r.next=50;break;case 18:if("balance"!=t){r.next=35;break}return r.next=21,this.getRuntimeSettings();case 21:return a=r.sent,r.next=24,this.resetRuntimeSettings();case 24:return r.next=26,this.getRuntimeSettings();case 26:(n=r.sent).barcodeFormatIds=a.barcodeFormatIds,n.barcodeFormatIds_2=a.barcodeFormatIds_2,n.region=a.region,n.deblurLevel=5,n.expectedBarcodesCount=512,n.localizationModes=[2,16,0,0,0,0,0,0],r.next=50;break;case 35:if("coverage"!=t){r.next=49;break}return r.next=38,this.getRuntimeSettings();case 38:return o=r.sent,r.next=41,this.resetRuntimeSettings();case 41:return r.next=43,this.getRuntimeSettings();case 43:(n=r.sent).barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,n.region=o.region,r.next=50;break;case 49:n=JSON.parse(t);case 50:r.next=55;break;case 52:if("object"==typeof t){r.next=54;break}throw TypeError("'UpdateRuntimeSettings(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");case 54:(n=JSON.parse(JSON.stringify(t))).region instanceof Array&&[(s=n.region).regionLeft,s.regionTop,s.regionLeft,s.regionBottom,s.regionMeasuredByPercentage].some((function(e){return void 0!==e}))&&(n.region={regionLeft:s.regionLeft||0,regionTop:s.regionTop||0,regionRight:s.regionRight||0,regionBottom:s.regionBottom||0,regionMeasuredByPercentage:s.regionMeasuredByPercentage||0});case 55:if(e._bUseFullFeature){r.next=60;break}if(0==(n.barcodeFormatIds&~(E.BF_ONED|E.BF_QR_CODE|E.BF_PDF417|E.BF_DATAMATRIX))&&0==n.barcodeFormatIds_2){r.next=58;break}throw Error("Some of the specified barcode formats are not supported in the compact version. Please try the full-featured version.");case 58:if(0==n.intermediateResultTypes){r.next=60;break}throw Error("Intermediate results is not supported in the compact version. Please try the full-featured version.");case 60:if(!this.bFilterRegionInJs){r.next=67;break}if(!((c=n.region)instanceof Array)){r.next=64;break}throw Error("The `region` of type `Array` is only allowed in `BarcodeScanner`.");case 64:this.userDefinedRegion=JSON.parse(JSON.stringify(c)),(c.regionLeft||c.regionTop||c.regionRight||c.regionBottom||c.regionMeasuredByPercentage)&&(c.regionLeft||c.regionTop||100!=c.regionRight||100!=c.regionBottom||!c.regionMeasuredByPercentage)?this.region=c:this.region=null,n.region={regionLeft:0,regionTop:0,regionRight:0,regionBottom:0,regionMeasuredByPercentage:0},r.next=68;break;case 67:this.userDefinedRegion=null,this.region=null;case 68:return r.next=70,new Promise((function(t,r){var i=e._nextTaskID++;e._taskCallbackMap.set(i,(function(e){if(e.success){try{d._handleRetJsonString(e.updateReturn)}catch(t){r(t)}return t()}var n=new Error(e.message);return n.stack=e.stack+"\n"+n.stack,r(n)})),e._dbrWorker.postMessage({type:"updateRuntimeSettings",id:i,instanceID:d._instanceID,body:{settings:JSON.stringify(n)}})}));case 70:return r.abrupt("return",r.sent);case 71:case"end":return r.stop()}}),r,this)})))}},{key:"resetRuntimeSettings",value:function(){return b(this,void 0,void 0,u().mark((function t(){var r=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.userDefinedRegion=null,this.region=null,t.next=4,new Promise((function(t,n){var i=e._nextTaskID++;e._taskCallbackMap.set(i,(function(e){if(e.success)return t();var r=new Error(e.message);return r.stack=e.stack+"\n"+r.stack,n(r)})),e._dbrWorker.postMessage({type:"resetRuntimeSettings",id:i,instanceID:r._instanceID})}));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"outputRuntimeSettingsToString",value:function(){return b(this,void 0,void 0,u().mark((function t(){var r=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e._bUseFullFeature){t.next=2;break}throw Error("outputRuntimeSettingsToString() is not supported in the compact version. Please try the full-featured version.");case 2:return t.next=4,new Promise((function(t,n){var i=e._nextTaskID++;e._taskCallbackMap.set(i,(function(e){if(e.success)return t(e.results);var r=new Error(e.message);return r.stack=e.stack+"\n"+r.stack,n(r)})),e._dbrWorker.postMessage({type:"outputRuntimeSettingsToString",id:i,instanceID:r._instanceID})}));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))}},{key:"initRuntimeSettingsWithString",value:function(t){return b(this,void 0,void 0,u().mark((function r(){var n=this;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e._bUseFullFeature){r.next=2;break}throw Error("initRuntimeSettingsWithString() is not supported in the compact version. Please try the full-featured version.");case 2:if("string"!=typeof t){r.next=6;break}t=t,r.next=9;break;case 6:if("object"==typeof t){r.next=8;break}throw TypeError("'initRuntimeSettingstWithString(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");case 8:t=JSON.stringify(t);case 9:return r.next=11,new Promise((function(r,i){var a=e._nextTaskID++;e._taskCallbackMap.set(a,(function(e){if(e.success){try{n._handleRetJsonString(e.initReturn)}catch(e){i(e)}return r()}var t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,i(t)})),e._dbrWorker.postMessage({type:"initRuntimeSettingsWithString",id:a,instanceID:n._instanceID,body:{settings:t}})}));case 11:return r.abrupt("return",r.sent);case 12:case"end":return r.stop()}}),r)})))}},{key:"_decode_Blob",value:function(t,r){return b(this,void 0,void 0,u().mark((function n(){var i,a,o;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e._onLog&&e._onLog("_decode_Blob(blob: Blob)"),i=null,a=null,"undefined"==typeof createImageBitmap){n.next=11;break}return n.prev=3,n.next=6,createImageBitmap(t);case 6:i=n.sent,n.next=11;break;case 9:n.prev=9,n.t0=n.catch(3);case 11:if(n.t1=i,n.t1){n.next=16;break}return n.next=15,function(e){return new Promise((function(t,r){var n=URL.createObjectURL(e),i=new Image;i.dbrObjUrl=n,i.src=n,i.onload=function(){t(i)},i.onerror=function(e){r(new Error("Can't convert blob to image : "+(e instanceof Event?e.type:e)))}}))}(t);case 15:a=n.sent;case 16:return n.next=18,this._decode_Image(i||a,r);case 18:return o=n.sent,n.abrupt("return",(i&&i.close(),o));case 20:case"end":return n.stop()}}),n,this,[[3,9]])})))}},{key:"_decode_ArrayBuffer",value:function(e,t){return b(this,void 0,void 0,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._decode_Blob(new Blob([e]),t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r,this)})))}},{key:"_decode_Uint8Array",value:function(e,t){return b(this,void 0,void 0,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this._decode_Blob(new Blob([e]),t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r,this)})))}},{key:"_decode_Image",value:function(t,r){return b(this,void 0,void 0,u().mark((function n(){var i,a,o,s,c,d,h,l,_,g,f,v,p,m,R,S;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e._onLog&&e._onLog("_decode_Image(image: HTMLImageElement|ImageBitmap)"),r=r||{},c=t instanceof HTMLImageElement?t.naturalWidth:t.width,d=t instanceof HTMLImageElement?t.naturalHeight:t.height,(h=r.region)?(h.regionMeasuredByPercentage?(l=h.regionLeft*c/100,_=h.regionTop*d/100,g=h.regionRight*c/100,f=h.regionBottom*d/100):(l=h.regionLeft,_=h.regionTop,g=h.regionRight,f=h.regionBottom),i=l,a=_,c=Math.round(g-l),d=Math.round(f-_)):(i=0,a=0),(v=Math.max(c,d))>this._canvasMaxWH?(p=this._canvasMaxWH/v,c>d?(o=this._canvasMaxWH,s=Math.round(d*p)):(o=Math.round(c*p),s=this._canvasMaxWH)):(o=c,s=d),(m=document.createElement("canvas")).width=o,m.height=s,m.getContext("2d").drawImage(t,i,a,c,d,0,0,o,s),t.dbrObjUrl&&URL.revokeObjectURL(t.dbrObjUrl),h?delete(R=JSON.parse(JSON.stringify(r))).region:R=r,n.next=8,this._decode_Canvas(m,R);case 8:return S=n.sent,n.abrupt("return",(e.fixResultLocationWhenFilterRegionInJs(h,S,i,a,c,d,o,s),S));case 10:case"end":return n.stop()}}),n,this)})))}},{key:"_decode_Canvas",value:function(t,r){return b(this,void 0,void 0,u().mark((function n(){var i;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e._onLog&&e._onLog("_decode_Canvas(canvas:HTMLCanvasElement)"),!t.crossOrigin||"anonymous"==t.crossOrigin){n.next=2;break}throw"cors";case 2:return this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=t,this.oriCanvasData=null),i=(t.dbrCtx2d||t.getContext("2d")).getImageData(0,0,t.width,t.height).data,n.next=6,this._decodeBuffer_Uint8Array(i,t.width,t.height,4*t.width,m.IPF_ABGR_8888,r);case 6:return n.abrupt("return",n.sent);case 7:case"end":return n.stop()}}),n,this)})))}},{key:"_decode_Video",value:function(t,r){return b(this,void 0,void 0,u().mark((function n(){var i,a,o,s,c,d,h,l,_,g,f,v,p,m,R;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e._onLog&&e._onLog("_decode_Video(video)"),t instanceof HTMLVideoElement){n.next=2;break}throw TypeError("'_decode_Video(video [, config] )': Type of 'video' should be 'HTMLVideoElement'.");case 2:if(!t.crossOrigin||"anonymous"==t.crossOrigin){n.next=4;break}throw"cors";case 4:return r=r||{},c=t.videoWidth,d=t.videoHeight,(h=r.region)?(h.regionMeasuredByPercentage?(l=h.regionLeft*c/100,_=h.regionTop*d/100,g=h.regionRight*c/100,f=h.regionBottom*d/100):(l=h.regionLeft,_=h.regionTop,g=h.regionRight,f=h.regionBottom),i=l,a=_,c=Math.round(g-l),d=Math.round(f-_)):(i=0,a=0),(v=Math.max(c,d))>this._canvasMaxWH?(p=this._canvasMaxWH/v,c>d?(o=this._canvasMaxWH,s=Math.round(d*p)):(o=Math.round(c*p),s=this._canvasMaxWH)):(o=c,s=d),m=null,(m=document.createElement("canvas")).width=o,m.height=s,(m.dbrCtx2d=m.getContext("2d")).drawImage(t,i,a,c,d,0,0,o,s),h?delete JSON.parse(JSON.stringify(r)).region:r,n.next=14,this._decode_Canvas(m,r);case 14:return R=n.sent,n.abrupt("return",(h&&e.fixResultLocationWhenFilterRegionInJs(h,R,i,a,c,d,o,s),R));case 16:case"end":return n.stop()}}),n,this)})))}},{key:"_decode_DCEFrame",value:function(t,r){return b(this,void 0,void 0,u().mark((function r(){var n,i,a,o,s,c,d,h,l,_,g,f,v,p,R,S;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e._onLog&&e._onLog("_decode_DCEFrame(dceFrame)"),t){r.next=2;break}return r.abrupt("return",null);case 2:if(this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,colorMode:t.colorMode,data:new Uint8Array(t.data),toCanvas:t.toCanvas}),"grey"!==t.colorMode){r.next=9;break}return i=t.data,a=t.width,o=t.height,s=t.timeStamp,c={timeStamp:s},r.next=6,this._decodeBuffer_Uint8Array(i,a,o,a,m.IPF_GrayScaled,c);case 6:n=r.sent,r.next=22;break;case 9:if("rgba"!==t.colorMode){r.next=16;break}return d=t.data,h=t.width,l=t.height,_=t.timeStamp,g={timeStamp:_},r.next=13,this._decodeBuffer_Uint8Array(d,h,l,4*h,m.IPF_ABGR_8888,g);case 13:n=r.sent,r.next=22;break;case 16:if("bgra"===t.colorMode){r.next=18;break}throw new Error("Color mode '".concat(t.colorMode,"' is not supported."));case 18:return f=t.data,v=t.width,p=t.height,R=t.timeStamp,S={timeStamp:R},r.next=21,this._decodeBuffer_Uint8Array(f,v,p,4*v,m.IPF_ARGB_8888,S);case 21:n=r.sent;case 22:return r.abrupt("return",n);case 23:case"end":return r.stop()}}),r,this)})))}},{key:"_decode_Base64",value:function(t,r){return b(this,void 0,void 0,u().mark((function n(){var i,a,o;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e._onLog&&e._onLog("_decode_Base64(base64Str)"),"string"==typeof t){n.next=2;break}return n.abrupt("return",Promise.reject("'_decode_Base64(base64Str, config)': Type of 'base64Str' should be 'string'."));case 2:for("data:image/"==t.substring(0,11)&&(t=t.substring(t.indexOf(",")+1)),i=atob(t),a=i.length,o=new Uint8Array(a);a--;)o[a]=i.charCodeAt(a);return n.next=7,this._decode_Blob(new Blob([o]),r);case 7:return n.abrupt("return",n.sent);case 8:case"end":return n.stop()}}),n,this)})))}},{key:"_decode_Url",value:function(t,r){return b(this,void 0,void 0,u().mark((function n(){var i,a=this;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e._onLog&&e._onLog("_decode_Url(url)"),"string"==typeof t){n.next=2;break}throw TypeError("'_decode_Url(url, config)': Type of 'url' should be 'string'.");case 2:return t=t,n.next=5,new Promise((function(e,r){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.send(),n.onloadend=function(){return b(a,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e(n.response);case 1:case"end":return t.stop()}}),t)})))},n.onerror=function(){r(new Error("Network Error: "+n.statusText))}}));case 5:return i=n.sent,n.next=8,this._decode_Blob(i,r);case 8:return n.abrupt("return",n.sent);case 9:case"end":return n.stop()}}),n,this)})))}},{key:"_decode_FilePath",value:function(t,r){return b(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw e._onLog&&e._onLog("_decode_FilePath(path)"),Error("'_decode_FilePath(path, config)': The method is only supported in node environment.");case 1:case"end":return t.stop()}}),t)})))}},{key:"_handleRetJsonString",value:function(t){var r=R;if(t.textResults){for(var n=0;n<t.textResults.length;n++){var i=t.textResults[n];try{for(var a=i.barcodeText,o="",s=0;s<a.length;s++)o+=String.fromCharCode(a[s]);try{i.barcodeText=decodeURIComponent(escape(o))}catch(t){i.barcodeText=o}}catch(t){i.barcodeText=""}null!=i.exception&&function(){e._setWarnnedEx.has(i.exception)||(e._setWarnnedEx.add(i.exception),console.warn(i.exception));var t={};i.exception.split(";").forEach((function(e){var r=e.indexOf(":");t[e.substring(0,r)]=e.substring(r+1)})),i.exception=t}()}return t.decodeRecords?this.decodeRecords=t.decodeRecords:this.decodeRecords={},this._lastErrorCode=t.exception,this._lastErrorString=t.description,t.exception&&!e._setWarnnedEx.has(t.description)&&(e._setWarnnedEx.add(t.description),console.warn(t.description)),t.textResults}if(t.exception==r.DBR_SUCCESS)return t.data;throw e.BarcodeReaderException(t.exception,t.description)}},{key:"setModeArgument",value:function(t,r,n,i){return b(this,void 0,void 0,u().mark((function a(){var o=this;return u().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,new Promise((function(a,s){var c=e._nextTaskID++;e._taskCallbackMap.set(c,(function(e){if(e.success){try{o._handleRetJsonString(e.setReturn)}catch(e){return s(e)}return a()}var t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,s(t)})),e._dbrWorker.postMessage({type:"setModeArgument",id:c,instanceID:o._instanceID,body:{modeName:t,index:r,argumentName:n,argumentValue:i}})}));case 2:return a.abrupt("return",a.sent);case 3:case"end":return a.stop()}}),a)})))}},{key:"getModeArgument",value:function(t,r,n){return b(this,void 0,void 0,u().mark((function i(){var a=this;return u().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,new Promise((function(i,o){var s=e._nextTaskID++;e._taskCallbackMap.set(s,(function(e){if(e.success){var t;try{t=a._handleRetJsonString(e.getReturn)}catch(e){return o(e)}return i(t)}var r=new Error(e.message);return r.stack=e.stack+"\n"+r.stack,o(r)})),e._dbrWorker.postMessage({type:"getModeArgument",id:s,instanceID:a._instanceID,body:{modeName:t,index:r,argumentName:n}})}));case 2:return i.abrupt("return",i.sent);case 3:case"end":return i.stop()}}),i)})))}},{key:"getIntermediateResults",value:function(){return b(this,void 0,void 0,u().mark((function t(){var r=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,new Promise((function(t,n){var i=e._nextTaskID++;e._taskCallbackMap.set(i,(function(e){if(e.success)return t(e.results);var r=new Error(e.message);return r.stack=e.stack+"\n"+r.stack,n(r)})),e._dbrWorker.postMessage({type:"getIntermediateResults",id:i,instanceID:r._instanceID})}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})))}},{key:"getIntermediateCanvas",value:function(){return b(this,void 0,void 0,u().mark((function t(){var r,n,i,a,o,s,c,d,h,l,_,g,f,p,R,E,y,I,b,A;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getIntermediateResults();case 2:r=t.sent,n=[],i=(0,v.Z)(r),t.prev=5,i.s();case 7:if((a=i.n()).done){t.next=52;break}if((o=a.value).dataType!=S.IMRDT_IMAGE){t.next=50;break}s=(0,v.Z)(o.results),t.prev=11,s.s();case 13:if((c=s.n()).done){t.next=42;break}d=c.value,h=d.bytes,l=void 0,t.t0=(e._onLog&&e._onLog(" "+h.length+" "+h.byteLength+" "+d.width+" "+d.height+" "+d.stride+" "+d.format),d.format),t.next=t.t0===m.IPF_ABGR_8888?20:t.t0===m.IPF_RGB_888?22:t.t0===m.IPF_GrayScaled?26:t.t0===m.IPF_Binary||t.t0===m.IPF_BinaryInverted?30:35;break;case 20:return l=new Uint8ClampedArray(h),t.abrupt("break",36);case 22:for(_=h.length/3,l=new Uint8ClampedArray(4*_),g=0;g<_;++g)l[4*g]=h[3*g+2],l[4*g+1]=h[3*g+1],l[4*g+2]=h[3*g],l[4*g+3]=255;return t.abrupt("break",36);case 26:for(f=h.length,l=new Uint8ClampedArray(4*f),p=0;p<f;p++)l[4*p]=l[4*p+1]=l[4*p+2]=h[p],l[4*p+3]=255;return t.abrupt("break",36);case 30:for(d.width=8*d.stride,d.height=h.length/d.stride,R=h.length,l=new Uint8ClampedArray(8*R*4),E=0;E<R;E++)for(y=h[E],I=0;I<8;++I)l[4*(8*E+I)]=l[4*(8*E+I)+1]=l[4*(8*E+I)+2]=(128&y)/128*255,l[4*(8*E+I)+3]=255,y<<=1;return t.abrupt("break",36);case 35:console.warn("unknow intermediate image",d);case 36:if(l){t.next=38;break}return t.abrupt("continue",40);case 38:b=new ImageData(l,d.width,d.height),(A=document.createElement("canvas")).width=d.width,A.height=d.height,A.getContext("2d").putImageData(b,0,0),n.push(A);case 40:t.next=13;break;case 42:t.next=47;break;case 44:t.prev=44,t.t1=t.catch(11),s.e(t.t1);case 47:return t.prev=47,s.f(),t.finish(47);case 50:t.next=7;break;case 52:t.next=57;break;case 54:t.prev=54,t.t2=t.catch(5),i.e(t.t2);case 57:return t.prev=57,i.f(),t.finish(57);case 60:return t.abrupt("return",n);case 61:case"end":return t.stop()}}),t,this,[[5,54,57,60],[11,44,47,50]])})))}},{key:"destroyContext",value:function(){if(e._onLog&&e._onLog("destroyContext()"),!this.bDestroyed){this.bDestroyed=!0;var t=e._nextTaskID++;e._taskCallbackMap.set(t,(function(e){if(!e.success){var t=new Error(e.message);throw t.stack=e.stack+"\n"+t.stack,t}})),e._dbrWorker.postMessage({type:"destroyContext",id:t,instanceID:this._instanceID})}}}],[{key:"version",get:function(){return this._version}},{key:"license",get:function(){return this._license},set:function(t){if("unload"!=this._loadWasmStatus)throw new Error("`license` is not allowed to change after `createInstance` or `loadWasm` is called.");e._license=t}},{key:"productKeys",get:function(){return this._license},set:function(t){e.license=t}},{key:"handshakeCode",get:function(){return this._license},set:function(t){e.license=t}},{key:"organizationID",get:function(){return this._license},set:function(t){e.license=t}},{key:"sessionPassword",get:function(){return this._sessionPassword},set:function(t){if("unload"!=this._loadWasmStatus)throw new Error("`sessionPassword` is not allowed to change after `createInstance` or `loadWasm` is called.");e._sessionPassword=t}},{key:"detectEnvironment",value:function(){return b(this,void 0,void 0,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t={wasm:"undefined"!=typeof WebAssembly&&("undefined"==typeof navigator||!(/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&/\(.+\s11_2_([2-6]).*\)/.test(navigator.userAgent))),worker:!("undefined"==typeof Worker),getUserMedia:!("undefined"==typeof navigator||!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia),camera:!1,browser:this.browserInfo.browser,version:this.browserInfo.version,OS:this.browserInfo.OS}).getUserMedia){e.next=11;break}return e.prev=2,e.next=5,navigator.mediaDevices.getUserMedia({video:!0});case 5:e.sent.getTracks().forEach((function(e){e.stop()})),t.camera=!0,e.next=11;break;case 9:e.prev=9,e.t0=e.catch(2);case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this,[[2,9]])})))}},{key:"engineResourcePath",get:function(){return this._engineResourcePath},set:function(t){if("unload"!=this._loadWasmStatus)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` or `loadWasm` is called.");if(null==t&&(t="./"),A)e._engineResourcePath=t;else{var r=document.createElement("a");r.href=t,e._engineResourcePath=r.href}this._engineResourcePath.endsWith("/")||(e._engineResourcePath+="/")}},{key:"licenseServer",get:function(){return this._licenseServer},set:function(t){if("unload"!=this._loadWasmStatus)throw new Error("`licenseServer` is not allowed to change after `createInstance` or `loadWasm` is called.");if(null==t)e._licenseServer=[];else{t instanceof Array||(t=[t]);for(var r=0;r<t.length;++r){if(!A){var n=document.createElement("a");n.href=t[r],t[r]=n.href}t[r].endsWith("/")||(t[r]+="/")}e._licenseServer=t}}},{key:"deviceFriendlyName",get:function(){return this._deviceFriendlyName},set:function(t){if("unload"!=this._loadWasmStatus)throw new Error("`deviceFriendlyName` is not allowed to change after `createInstance` or `loadWasm` is called.");e._deviceFriendlyName=t||""}},{key:"_bUseFullFeature",get:function(){return this.__bUseFullFeature},set:function(t){if("unload"!=this._loadWasmStatus)throw new Error("`_bUseFullFeature` is not allowed to change after `createInstance` or `loadWasm` is called.");e.__bUseFullFeature=t}},{key:"isWasmLoaded",value:function(){return"loadSuccess"==this._loadWasmStatus}},{key:"lastErrorCode",get:function(){return this._lastErrorCode}},{key:"lastErrorString",get:function(){return this._lastErrorString}},{key:"loadWasm",value:function(){return b(this,void 0,void 0,u().mark((function t(){var r,n,i,a,o,s,c,d,h,l,_,g,f=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e._loadWasmStatus,t.next="unload"===t.t0?3:"loading"===t.t0?20:"loadSuccess"===t.t0?23:"loadFail"===t.t0?24:25;break;case 3:if(n=e._license,i=JSON.parse(JSON.stringify(e._licenseServer)),a=e._sessionPassword,o=null,s=null,c=0,n.startsWith("t")||n.startsWith("f")?c=0:0===n.length||n.startsWith("P")||n.startsWith("L")||n.startsWith("Y")||n.startsWith("A")?c=1:(c=2,-1!=(d=n.indexOf(":"))&&(n=n.substring(d+1)),n.startsWith("DLS2")&&(h=n.substring(4),h=atob(h),(l=JSON.parse(h)).handshakeCode?n=l.handshakeCode:l.organizationID&&(n=l.organizationID),"number"==typeof n&&(n=JSON.stringify(n)),n||(n=""),0===i.length&&(_=[],l.mainServerURL&&(_[0]=l.mainServerURL),l.standbyServerURL&&(_[1]=l.standbyServerURL),e.licenseServer=_,i=e.licenseServer),!a&&l.sessionPassword&&(a=l.sessionPassword),l.chargeWay&&(s=l.chargeWay),l.limitedLicenseModules&&(o=l.limitedLicenseModules))),c&&(w.crypto||(r="Please upgrade your browser to support online key."),w.crypto.subtle||(r="Require https to use online key in this browser.")),!r){t.next=9;break}if(1===c){t.next=8;break}throw new Error(r);case 8:c=0,console.warn(r),e._lastErrorCode=R.DMERR_FAILED_TO_REACH_LTS,e._lastErrorString=r;case 9:if(1===c&&(n="",console.warn("Applying for a public trial license ...")),e._loadWasmStatus="loading",g=e.engineResourcePath+e._workerName,t.t1=e.engineResourcePath.startsWith(location.origin),t.t1){t.next=16;break}return t.next=15,fetch(g).then((function(e){return e.blob()})).then((function(e){return URL.createObjectURL(e)}));case 15:g=t.sent;case 16:e._dbrWorker=new Worker(g),e._dbrWorker.onerror=function(t){e._loadWasmStatus="loadFail";var r=new Error(t.message);e._loadWasmErr=r;var n,i=(0,v.Z)(e._loadWasmCallbackArr);try{for(i.s();!(n=i.n()).done;){(0,n.value)(r)}}catch(a){i.e(a)}finally{i.f()}e._loadWasmCallbackArr=[]},e._dbrWorker.onmessage=function(t){return b(f,void 0,void 0,u().mark((function r(){var n,i,a,o,s,d,h,l,_;return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=t.data?t.data:t,r.t0=n.type,r.next="log"===r.t0?4:"load"===r.t0?6:"task"===r.t0?11:20;break;case 4:return e._onLog&&e._onLog(n.message),r.abrupt("break",21);case 6:if(n.message&&(n.message=n.message.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamsoft-barcode-reader/#javascript)")),i=!1,1===c&&(i=!0),n.success){e._loadWasmStatus="loadSuccess",e._version=n.version+"(JS "+e._jsVersion+"."+e._jsEditVersion+")",e._onLog&&e._onLog("load dbr worker success"),a=(0,v.Z)(e._loadWasmCallbackArr);try{for(a.s();!(o=a.n()).done;)(0,o.value)()}catch(u){a.e(u)}finally{a.f()}e._loadWasmCallbackArr=[],e._dbrWorker.onerror=null,n.message&&console.warn(n.message)}else{(s=new Error(n.message)).stack=n.stack+"\n"+s.stack,e._loadWasmStatus="loadFail",e._loadWasmErr=s,d=(0,v.Z)(e._loadWasmCallbackArr);try{for(d.s();!(h=d.n()).done;)(0,h.value)(s)}catch(u){d.e(u)}finally{d.f()}e._loadWasmCallbackArr=[],i||111==n.ltsErrorCode&&-1!=n.message.toLowerCase().indexOf("trial license")&&(i=!0)}return i&&e.showDialog(n.success?"warn":"error",n.message),r.abrupt("break",21);case 11:l=n.id,_=n.body,r.prev=12,e._taskCallbackMap.get(l)(_),e._taskCallbackMap.delete(l),r.next=19;break;case 16:throw r.prev=16,r.t1=r.catch(12),e._taskCallbackMap.delete(l),r.t1;case 19:return r.abrupt("break",21);case 20:e._onLog&&e._onLog(t);case 21:case"end":return r.stop()}}),r,null,[[12,16]])})))},e._dbrWorker.postMessage({type:"loadWasm",bd:e._bWasmDebug,engineResourcePath:e.engineResourcePath,version:e._jsVersion,brtk:!!c,bptk:1===c,lcs:n,dm:location.origin.startsWith("http")?location.origin:"https://localhost",bUseFullFeature:e._bUseFullFeature,browserInfo:e.browserInfo,deviceFriendlyName:e.deviceFriendlyName,ls:i,sp:a,lm:o,cw:s});case 20:return t.next=22,new Promise((function(t,r){e._loadWasmCallbackArr.push((function(e){e?r(e):t()}))}));case 22:case 23:return t.abrupt("break",26);case 24:throw e._loadWasmErr;case 25:throw new Error("Unexpected status");case 26:case"end":return t.stop()}}),t)})))}},{key:"showDialog",value:function(t,r){return b(this,void 0,void 0,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e._bNeverShowDialog){n.next=8;break}return n.prev=1,n.delegateYield(u().mark((function n(){var i,a,o,s,c,d,h,l,_,g,f,p,m,R,S,E,y,I,b,A,w,T,D,k;return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,fetch(e.engineResourcePath+"dls.license.dialog.html");case 2:if((i=n.sent).ok){n.next=5;break}throw Error("Get license dialog fail. Network Error: "+i.statusText);case 5:return n.next=7,i.text();case 7:if((a=n.sent).trim().startsWith("<")){n.next=10;break}throw Error("Get license dialog fail. Can't get valid HTMLElement.");case 10:for((o=document.createElement("div")).innerHTML=a,s=[],c=0;c<o.childElementCount;++c)(d=o.children[c])instanceof HTMLStyleElement&&(s.push(d),document.head.append(d));(h=1==o.childElementCount?o.children[0]:o).remove(),m=[h],R=h.children,S=(0,v.Z)(R);try{for(S.s();!(E=S.n()).done;)y=E.value,m.push(y)}catch(u){S.e(u)}finally{S.f()}for(I=0;I<m.length;++I){b=(0,v.Z)(m[I].children);try{for(b.s();!(A=b.n()).done;)w=A.value,m.push(w)}catch(u){b.e(u)}finally{b.f()}}for(T=function(){var e=k[D];if(!l&&e.classList.contains("dls-license-mask"))l=e,e.addEventListener("click",(function(t){if(e==t.target){h.remove();var r,n=(0,v.Z)(s);try{for(n.s();!(r=n.n()).done;){r.value.remove()}}catch(u){n.e(u)}finally{n.f()}}}));else if(!_&&e.classList.contains("dls-license-icon-close"))_=e,e.addEventListener("click",(function(){h.remove();var e,t=(0,v.Z)(s);try{for(t.s();!(e=t.n()).done;){e.value.remove()}}catch(u){t.e(u)}finally{t.f()}}));else if(!g&&e.classList.contains("dls-license-icon-error"))g=e,"error"!=t&&e.remove();else if(!f&&e.classList.contains("dls-license-icon-warn"))f=e,"warn"!=t&&e.remove();else if(!p&&e.classList.contains("dls-license-msg-content")){p=e;for(var n=r;n;){var i=n.indexOf("["),a=n.indexOf("]",i),o=n.indexOf("(",a),c=n.indexOf(")",o);if(-1==i||-1==a||-1==o||-1==c){e.appendChild(new Text(n));break}i>0&&e.appendChild(new Text(n.substring(0,i)));var d=document.createElement("a"),m=n.substring(i+1,a);d.innerText=m;var R=n.substring(o+1,c);d.setAttribute("href",R),d.setAttribute("target","_blank"),e.appendChild(d),n=n.substring(c+1)}}},D=0,k=m;D<k.length;D++)T();document.body.appendChild(h);case 23:case"end":return n.stop()}}),n)}))(),"t0",3);case 3:n.next=8;break;case 5:n.prev=5,n.t1=n.catch(1),e._onLog&&e._onLog(n.t1.message||n.t1);case 8:case"end":return n.stop()}}),n,null,[[1,5]])})))}},{key:"createInstanceInWorker",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return b(this,void 0,void 0,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.loadWasm();case 2:return r.next=4,new Promise((function(r,n){var i=e._nextTaskID++;e._taskCallbackMap.set(i,(function(e){if(e.success)return r(e.instanceID);var t=new Error(e.message);return t.stack=e.stack+"\n"+t.stack,n(t)})),e._dbrWorker.postMessage({type:"createInstance",id:i,bScanner:t})}));case 4:return r.abrupt("return",r.sent);case 5:case"end":return r.stop()}}),r)})))}},{key:"createInstance",value:function(){return b(this,void 0,void 0,u().mark((function t(){var r;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=new e,t.next=3,e.createInstanceInWorker();case 3:return r._instanceID=t.sent,t.abrupt("return",r);case 5:case"end":return t.stop()}}),t)})))}},{key:"fixResultLocationWhenFilterRegionInJs",value:function(e,t,r,n,i,a,o,s){if(e&&t.length>0){var c,u=(0,v.Z)(t);try{for(u.s();!(c=u.n()).done;){var d=c.value.localizationResult;2==d.resultCoordinateType&&(d.x1*=.01*o,d.x2*=.01*o,d.x3*=.01*o,d.x4*=.01*o,d.y1*=.01*s,d.y2*=.01*s,d.y3*=.01*s,d.y4*=.01*s);var h=o/i,l=s/a;d.x1=d.x1/h+r,d.x2=d.x2/h+r,d.x3=d.x3/h+r,d.x4=d.x4/h+r,d.y1=d.y1/l+n,d.y2=d.y2/l+n,d.y3=d.y3/l+n,d.y4=d.y4/l+n,2==d.resultCoordinateType&&(d.x1*=100/i,d.x2*=100/i,d.x3*=100/i,d.x4*=100/i,d.y1*=100/a,d.y2*=100/a,d.y3*=100/a,d.y4*=100/a)}}catch(_){u.e(_)}finally{u.f()}}}},{key:"BarcodeReaderException",value:function(e,t){var r,n=R.DBR_UNKNOWN;return"number"==typeof e?(n=e,r=new Error(t)):r=new Error(e),r.code=n,r}}]),e}();T._jsVersion="9.0.0",T._jsEditVersion="20220322",T._version="loading...(JS "+T._jsVersion+"."+T._jsEditVersion+")",T._license=!A&&document.currentScript&&(document.currentScript.getAttribute("data-license")||document.currentScript.getAttribute("data-productKeys")||document.currentScript.getAttribute("data-licenseKey")||document.currentScript.getAttribute("data-handshakeCode")||document.currentScript.getAttribute("data-organizationID"))||"",T._sessionPassword=!A&&document.currentScript&&document.currentScript.getAttribute("data-sessionPassword")||"",T.browserInfo=function(){if(!A){var e={init:function(){this.browser=this.searchString(this.dataBrowser)||"unknownBrowser",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||"unknownVersion",this.OS=this.searchString(this.dataOS)||"unknownOS","Linux"==this.OS&&-1!=navigator.userAgent.indexOf("Windows NT")&&(this.OS="HarmonyOS")},searchString:function(e){for(var t=0;t<e.length;t++){var r=e[t].string,n=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,r){if(-1!=r.indexOf(e[t].subString))return e[t].identity}else if(n)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"Edge",identity:"Edge"},{string:navigator.userAgent,subString:"OPR",identity:"OPR"},{string:navigator.userAgent,subString:"Chrome",identity:"Chrome"},{string:navigator.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:navigator.userAgent,subString:"Firefox",identity:"Firefox"},{string:navigator.userAgent,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:navigator.userAgent,subString:"HarmonyOS",identity:"HarmonyOS"},{string:navigator.userAgent,subString:"Android",identity:"Android"},{string:navigator.userAgent,subString:"iPhone",identity:"iPhone"},{string:navigator.platform,subString:"Win",identity:"Windows"},{string:navigator.platform,subString:"Mac",identity:"Mac"},{string:navigator.platform,subString:"Linux",identity:"Linux"}]};return e.init(),{browser:e.browser,version:e.version,OS:e.OS}}if(A)return{browser:"ssr",version:0,OS:"ssr"}}(),T._workerName="dbr-"+T._jsVersion+".worker.js",T._engineResourcePath=function(){if(!A&&document.currentScript){var e=document.currentScript.src,t=e.indexOf("?");if(-1!=t)e=e.substring(0,t);else{var r=e.indexOf("#");-1!=r&&(e=e.substring(0,r))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"}(),T._licenseServer=[],T._deviceFriendlyName="",T._isShowRelDecodeTimeInResults=!1,T._bWasmDebug=!1,T._bNeverShowDialog=!1,T.__bUseFullFeature=!0,T._nextTaskID=0,T._taskCallbackMap=new Map,T._loadWasmStatus="unload",T._loadWasmCallbackArr=[],T._lastErrorCode=0,T._lastErrorString="",T._setWarnnedEx=new Set,T._loadWasmErr=null,"object"==typeof r.g&&r.g.process&&r.g.process.release&&r.g.process.release.name;var D,k,C,M,L,x,O,F,N,B,P,V,U,G,W,H,Z,J,K,Y,Q,j,X,z,q,$,ee,te=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;return(0,i.Z)(this,r),(e=t.call(this)).intervalTime=0,e._intervalGetVideoFrame=0,e.array_getFrameTimeCost=[],e.array_decodeFrameTimeCost=[],e._indexCurrentDecodingFrame=0,e.resultsOverlay=null,e._bPauseScan=!1,e._intervalDetectVideoPause=1e3,e._soundOnSuccessfullRead=new Audio("data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"),e.bPlaySoundOnSuccessfulRead=!1,e.bVibrateOnSuccessfulRead=!1,e.vibrateDuration=300,e.barcodeFillStyle="rgba(254,180,32,0.3)",e.barcodeStrokeStyle="rgba(254,180,32,0.9)",e.barcodeLineWidth=1,e.beingLazyDrawRegionsults=!1,e.dce=null,e._onCameraSelChange=function(){},e._onResolutionSelChange=function(){},e._onCloseBtnClick=function(){},e._onPlayed=null,e}return(0,a.Z)(r,[{key:"getUIElement",value:function(){return this.dce.getUIElement()}},{key:"setUIElement",value:function(e){return b(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.dce.setUIElement(e);case 2:case"end":return t.stop()}}),t,this)})))}},{key:"singleFrameMode",get:function(){return this.dce.singleFrameMode},set:function(e){var t=this;this.dce.singleFrameMode=e,e?(this.dce.ifShowScanRegionLaser=!1,b(t,void 0,void 0,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getScanSettings();case 2:return(t=e.sent).oneDTrustFrameCount=1,e.next=6,this.updateScanSettings(t);case 6:case"end":return e.stop()}}),e,this)})))):this.dce.ifShowScanRegionLaser=!0}},{key:"_assertOpen",value:function(){if(!this.dce.isOpen())throw Error("The scanner is not open.")}},{key:"soundOnSuccessfullRead",get:function(){return this._soundOnSuccessfullRead},set:function(e){e instanceof HTMLAudioElement?this._soundOnSuccessfullRead=e:this._soundOnSuccessfullRead=new Audio(e)}},{key:"whenToPlaySoundforSuccessfulRead",get:function(){return!0===this.bPlaySoundOnSuccessfulRead?"frame":this.bPlaySoundOnSuccessfulRead?this.bPlaySoundOnSuccessfulRead:"never"},set:function(e){this.bPlaySoundOnSuccessfulRead="never"!==e&&e}},{key:"whenToVibrateforSuccessfulRead",get:function(){return!0===this.bVibrateOnSuccessfulRead?"frame":this.bVibrateOnSuccessfulRead?this.bVibrateOnSuccessfulRead:"never"},set:function(e){this.bVibrateOnSuccessfulRead="never"!==e&&e}},{key:"regionMaskFillStyle",get:function(){return this.dce.regionMaskFillStyle},set:function(e){this.dce.setScanRegionMaskStyle({regionMaskFillStyle:e})}},{key:"regionMaskStrokeStyle",get:function(){return this.dce.regionMaskStrokeStyle},set:function(e){this.dce.setScanRegionMaskStyle({regionMaskStrokeStyle:e})}},{key:"regionMaskLineWidth",get:function(){return this.dce.regionMaskLineWidth},set:function(e){this.dce.setScanRegionMaskStyle({regionMaskLineWidth:e})}},{key:"region",get:function(){return this._region},set:function(e){this._region=e,this.dce&&(e?e instanceof Array||this.dce.setScanRegion(e):this.dce.setScanRegion(null)),this.singleFrameMode||(this.beingLazyDrawRegionsults=!0),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}},{key:"ifSaveOriginalImageInACanvas",get:function(){return this._ifSaveOriginalImageInACanvas},set:function(e){this._ifSaveOriginalImageInACanvas=e,this.dce.frameColorMode=e?"rgba":"grey"}},{key:"createDCEInstance",value:function(){return b(this,void 0,void 0,u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.dce,e.t0){e.next=14;break}return T._onLog&&T._onLog("createDCEInstance()"),I.defaultUIElementURL=null,e.next=6,I.createInstance();case 6:this.dce=e.sent,this.dce.refreshInterval=200,this.dce.frameColorMode="grey",this.dce.maxCvsSideLength="iPhone"==r.browserInfo.OS||"Android"==r.browserInfo.OS?2048:4096,this.dce.on("cameraChange",(function(){t.array_decodeFrameTimeCost.length=0,t.array_getFrameTimeCost.length=0,t._intervalGetVideoFrame=0})),this.dce.on("resolutionChange",(function(){t.array_decodeFrameTimeCost.length=0,t.array_getFrameTimeCost.length=0,t._intervalGetVideoFrame=0})),this.dce.on("cameraClose",(function(){t.array_decodeFrameTimeCost.length=0,t.array_getFrameTimeCost.length=0,t._intervalGetVideoFrame=0,t._bPauseScan=!1})),this.dce.on("singleFrameAcquired",(function(e){return b(t,void 0,void 0,u().mark((function t(){var r,n,i,a,o,s;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:if(e.data){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,this._decode_DCEFrame(e);case 6:return r=t.sent,t.next=9,this.clearMapDecodeRecord();case 9:n=(0,v.Z)(r);try{for(n.s();!(i=n.n()).done;)delete i.value.bUnduplicated}catch(c){n.e(c)}finally{n.f()}if(this._drawResults(r),this.onFrameRead&&this.isOpen()&&!this._bPauseScan&&this.onFrameRead(r),this.onUniqueRead&&this.isOpen()&&!this._bPauseScan){a=(0,v.Z)(r);try{for(a.s();!(o=a.n()).done;)s=o.value,this.onUniqueRead(s.barcodeText,s)}catch(c){a.e(c)}finally{a.f()}}case 12:case"end":return t.stop()}}),t,this)})))}));case 14:case"end":return e.stop()}}),e,this)})))}},{key:"decodeCurrentFrame",value:function(e){return b(this,void 0,void 0,u().mark((function t(){var r,n;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._assertOpen(),r=null,e&&e.region&&(r=e.region),n=this.dce._getVideoFrame(r),t.abrupt("return",this._decode_DCEFrame(n));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"clearMapDecodeRecord",value:function(){return b(this,void 0,void 0,u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,r){var n=T._nextTaskID++;T._taskCallbackMap.set(n,(function(t){if(t.success)return e();var n=new Error(t.message);return n.stack=t.stack+"\n"+n.stack,r(n)})),T._dbrWorker.postMessage({type:"clearMapDecodeRecord",id:n,instanceID:t._instanceID})}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{key:"updateRuntimeSettings",value:function(e){return b(this,void 0,void 0,u().mark((function t(){var n,i,a,o,s,c,d,h,l,_=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("string"!=typeof e){t.next=72;break}if("speed"!=e){t.next=15;break}return t.next=4,this.getRuntimeSettings();case 4:return i=t.sent,t.next=7,this.resetRuntimeSettings();case 7:return t.next=9,this.getRuntimeSettings();case 9:(n=t.sent).barcodeFormatIds=i.barcodeFormatIds,n.barcodeFormatIds_2=i.barcodeFormatIds_2,i.region||(n.region=i.region),t.next=70;break;case 15:if("balance"!=e){t.next=33;break}return t.next=18,this.getRuntimeSettings();case 18:return a=t.sent,t.next=21,this.resetRuntimeSettings();case 21:return t.next=23,this.getRuntimeSettings();case 23:(n=t.sent).barcodeFormatIds=a.barcodeFormatIds,n.barcodeFormatIds_2=a.barcodeFormatIds_2,a.region||(n.region=a.region),n.deblurLevel=3,n.expectedBarcodesCount=512,n.localizationModes=[2,16,0,0,0,0,0,0],n.timeout=1e5,t.next=70;break;case 33:if("coverage"!=e){t.next=52;break}return t.next=36,this.getRuntimeSettings();case 36:return o=t.sent,t.next=39,this.resetRuntimeSettings();case 39:return t.next=41,this.getRuntimeSettings();case 41:(n=t.sent).barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,o.region||(n.region=o.region),n.deblurLevel=5,n.expectedBarcodesCount=512,n.scaleDownThreshold=1e5,n.localizationModes=[2,16,4,8,0,0,0,0],n.timeout=1e5,t.next=70;break;case 52:if("single"!=e){t.next=69;break}return t.next=55,this.getRuntimeSettings();case 55:return s=t.sent,t.next=58,this.resetRuntimeSettings();case 58:return t.next=60,this.getRuntimeSettings();case 60:(n=t.sent).barcodeFormatIds=s.barcodeFormatIds,n.barcodeFormatIds_2=s.barcodeFormatIds_2,r.isRegionNormalPreset(s.region)?n.region=null:n.region=s.region,n.expectedBarcodesCount=1,n.localizationModes=[16,2,0,0,0,0,0,0],n.barcodeZoneMinDistanceToImageBorders=0,t.next=70;break;case 69:n=JSON.parse(e);case 70:t.next=75;break;case 72:if("object"==typeof e){t.next=74;break}throw TypeError("'UpdateRuntimeSettings(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");case 74:(n=JSON.parse(JSON.stringify(e))).region instanceof Array&&[(c=e.region).regionLeft,c.regionTop,c.regionLeft,c.regionBottom,c.regionMeasuredByPercentage].some((function(e){return void 0!==e}))&&(n.region={regionLeft:c.regionLeft||0,regionTop:c.regionTop||0,regionRight:c.regionRight||0,regionBottom:c.regionBottom||0,regionMeasuredByPercentage:c.regionMeasuredByPercentage||0});case 75:if(T._bUseFullFeature){t.next=80;break}if(0==(n.barcodeFormatIds&~(E.BF_ONED|E.BF_QR_CODE|E.BF_PDF417|E.BF_DATAMATRIX))&&0==n.barcodeFormatIds_2){t.next=78;break}throw Error("Some of the specified barcode formats are not supported in the compact version. Please try the full-featured version.");case 78:if(0==n.intermediateResultTypes){t.next=80;break}throw Error("Intermediate results is not supported in the compact version. Please try the full-featured version.");case 80:if(d=n.region,this.bFilterRegionInJs?this.userDefinedRegion=JSON.parse(JSON.stringify(d)):this.userDefinedRegion=null,d instanceof Array)if(d.length){for(h=0;h<d.length;++h)(l=d[h])&&((l.regionLeft||l.regionTop||l.regionRight||l.regionBottom||l.regionMeasuredByPercentage)&&(l.regionLeft||l.regionTop||100!=l.regionRight||100!=l.regionBottom||!l.regionMeasuredByPercentage)||(d[h]=null));this.region=d}else this.region=null;else d&&(d.regionLeft||d.regionTop||d.regionRight||d.regionBottom||d.regionMeasuredByPercentage)&&(d.regionLeft||d.regionTop||100!=d.regionRight||100!=d.regionBottom||!d.regionMeasuredByPercentage)?this.region=d:this.region=null;return this.bFilterRegionInJs&&(n.region={regionLeft:0,regionTop:0,regionRight:0,regionBottom:0,regionMeasuredByPercentage:0}),t.next=85,new Promise((function(e,t){var r=T._nextTaskID++;T._taskCallbackMap.set(r,(function(r){if(r.success){try{_._handleRetJsonString(r.updateReturn)}catch(e){t(e)}return e()}var n=new Error(r.message);return n.stack=r.stack+"\n"+n.stack,t(n)})),T._dbrWorker.postMessage({type:"updateRuntimeSettings",id:r,instanceID:_._instanceID,body:{settings:JSON.stringify(n)}})}));case 85:if(t.t0="single"==e,!t.t0){t.next=95;break}return t.next=89,this.setModeArgument("BinarizationModes",0,"EnableFillBinaryVacancy","0");case 89:return t.next=91,this.setModeArgument("LocalizationModes",0,"ScanDirection","2");case 91:return t.next=93,this.setModeArgument("BinarizationModes",0,"BlockSizeX","71");case 93:return t.next=95,this.setModeArgument("BinarizationModes",0,"BlockSizeY","71");case 95:case"end":return t.stop()}}),t,this)})))}},{key:"_bindUI",value:function(){if(!this.getUIElement())throw new Error("Need to define `UIElement` before opening.");if(this.dce._bindUI(),!this.dce.video)throw this._unbindUI(),Error("Can not find the video container element with class 'dce-video-container'")}},{key:"_unbindUI",value:function(){this.dce._unbindUI()}},{key:"onPlayed",get:function(){return this._onPlayed},set:function(e){this.dce.off("played",this._onPlayed),this._onPlayed=e,this.dce.on("played",this._onPlayed)}},{key:"getAllCameras",value:function(){return b(this,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dce.getAllCameras());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"getCurrentCamera",value:function(){return b(this,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dce.getSelectedCamera());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"setCurrentCamera",value:function(e){return b(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.dce.selectCamera(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"getResolution",value:function(){return this.dce.getResolution()}},{key:"setResolution",value:function(e,t){return b(this,void 0,void 0,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.dce.setResolution(e,t));case 1:case"end":return r.stop()}}),r,this)})))}},{key:"getScanSettings",value:function(){return b(this,void 0,void 0,u().mark((function e(){var t=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,r){var n=T._nextTaskID++;T._taskCallbackMap.set(n,(function(n){if(n.success){var i=n.results;return i.intervalTime=t.intervalTime,i.whenToPlaySoundforSuccessfulRead=t.whenToPlaySoundforSuccessfulRead,i.soundOnSuccessfullRead=t.soundOnSuccessfullRead.src,i.whenToVibrateforSuccessfulRead=t.whenToVibrateforSuccessfulRead,i.vibrateDuration=t.vibrateDuration,e(i)}var a=new Error(n.message);return a.stack+="\n"+n.stack,r(a)})),T._dbrWorker.postMessage({type:"getScanSettings",id:n,instanceID:t._instanceID})}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}},{key:"updateScanSettings",value:function(e){return b(this,void 0,void 0,u().mark((function t(){var n,i=this;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return(n=JSON.parse(JSON.stringify(e))).hasOwnProperty("intervalTime")&&(this.intervalTime=n.intervalTime,delete n.intervalTime),n.hasOwnProperty("whenToPlaySoundforSuccessfulRead")&&(this.whenToPlaySoundforSuccessfulRead=n.whenToPlaySoundforSuccessfulRead,delete n.whenToPlaySoundforSuccessfulRead),n.hasOwnProperty("soundOnSuccessfullRead")&&(this.soundOnSuccessfullRead.src=n.soundOnSuccessfullRead,delete n.soundOnSuccessfullRead),n.hasOwnProperty("whenToVibrateforSuccessfulRead")&&(this.whenToVibrateforSuccessfulRead=n.whenToVibrateforSuccessfulRead,delete n.whenToVibrateforSuccessfulRead),n.hasOwnProperty("vibrateDuration")&&(this.vibrateDuration=n.vibrateDuration,delete n.vibrateDuration),t.next=10,new Promise((function(e,t){var a=T._nextTaskID++;T._taskCallbackMap.set(a,(function(r){if(r.success)return e();var n=new Error(r.message);return n.stack+="\n"+r.stack,t(n)})),r._dbrWorker.postMessage({type:"updateScanSettings",id:a,instanceID:i._instanceID,body:{settings:n}})}));case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t,this)})))}},{key:"getVideoSettings",value:function(){return this.dce.getVideoSettings()}},{key:"updateVideoSettings",value:function(e){return this.dce.updateVideoSettings(e)}},{key:"isOpen",value:function(){return this.dce&&this.dce.isOpen()}},{key:"stop",value:function(){this.dce.stop(),this.dce.hideScanRegionLaser(),this.dce.hideViewDecorator(),this.dce.hideScanRegionOverlays(),this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}},{key:"pause",value:function(){this.dce.pause()}},{key:"play",value:function(e,t,r){return b(this,void 0,void 0,u().mark((function n(){return u().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.dce.play(e,t,r));case 1:case"end":return n.stop()}}),n,this)})))}},{key:"pauseScan",value:function(){this._assertOpen(),this._bPauseScan=!0,this.dce.ifShowScanRegionLaser=!1}},{key:"resumeScan",value:function(){this._assertOpen(),this._bPauseScan=!1,this.dce.ifShowScanRegionLaser=!0}},{key:"getCapabilities",value:function(){return this.dce.getCapabilities()}},{key:"getCameraSettings",value:function(){return this.dce.getCameraSettings()}},{key:"getConstraints",value:function(){return this.dce.getConstraints()}},{key:"applyConstraints",value:function(e){return b(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.dce.applyConstraints(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"turnOnTorch",value:function(){return b(this,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dce.turnOnTorch());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"turnOffTorch",value:function(){return b(this,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.dce.turnOffTorch());case 1:case"end":return e.stop()}}),e,this)})))}},{key:"setColorTemperature",value:function(e){return b(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.dce.setColorTemperature(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"setExposureCompensation",value:function(e){return b(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.dce.setExposureCompensation(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"setZoom",value:function(e){return b(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.dce.setZoom(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"setFrameRate",value:function(e){return b(this,void 0,void 0,u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.dce.setFrameRate(e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"getFrameRate",value:function(){return this.dce.getFrameRate()}},{key:"setFocus",value:function(e,t){return b(this,void 0,void 0,u().mark((function r(){return u().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",this.dce.setFocus(e,t));case 1:case"end":return r.stop()}}),r,this)})))}},{key:"getFocus",value:function(){return this.dce.getFocus()}},{key:"_cloneDecodeResults",value:function(e){if(e instanceof Array){var t,r=[],n=(0,v.Z)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;r.push(this._cloneDecodeResults(i))}}catch(o){n.e(o)}finally{n.f()}return r}var a=e;return JSON.parse(JSON.stringify(a,(function(e,t){return"oriVideoCanvas"==e||"searchRegionCanvas"==e?void 0:t})))}},{key:"_loopReadVideo",value:function(){return b(this,void 0,void 0,u().mark((function e(){var t,r=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.bDestroyed){e.next=2;break}return e.abrupt("return",void this.dce.stopFetchingLoop());case 2:if(this.isOpen()){e.next=7;break}return this.dce.stopFetchingLoop(),e.next=6,this.clearMapDecodeRecord();case 6:return e.abrupt("return",void e.sent);case 7:if(this.dce.video&&!this.dce.video.paused&&!this._bPauseScan){e.next=14;break}return T._onLog&&T._onLog("Video or scan is paused. Ask in 1s."),this.dce.stopFetchingLoop(),e.next=12,this.clearMapDecodeRecord();case 12:return this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),e.abrupt("return",void(this._loopReadVideoTimeoutId=setTimeout((function(){r._loopReadVideo()}),this._intervalDetectVideoPause)));case 14:if(this.dce.ifShowScanRegionLaser=!0,T._onLog&&T._onLog("======= once read ======="),T._onLog&&(this._timeStartDecode=Date.now()),t=this._getVideoFrame()){e.next=18;break}return e.abrupt("return",(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout((function(){r._loopReadVideo()}),0))));case 18:b(r,void 0,void 0,u().mark((function e(){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(t._bUseWebGL||"grey"!==t.colorMode||(this.dce.frameColorMode="rgba"),this._decode_DCEFrame(t)));case 1:case"end":return e.stop()}}),e,this)}))).then((function(e){T._onLog&&T._onLog(e);var t=r.array_decodeFrameTimeCost,n=r.array_getFrameTimeCost,i=r._indexCurrentDecodingFrame;if(function(){if(r.region instanceof Array){for(t[i]&&t[i]instanceof Array||(t[i]=[]);t[i].length>=5;)t[i].shift();t[i].push(r._lastInnerDecodeDuration)}else{for(;t.length>=5;)t.shift();t.push(r._lastInnerDecodeDuration)}}(),r._intervalGetVideoFrame=function(){var e=0;if(r.region instanceof Array){var a,o;o=(a=i+1>=r.region.length?0:i+1)+1>=r.region.length?0:a+1,e=t[a]&&t[a].length&&n[o]&&n[o].length?Math.min.apply(Math,(0,l.Z)(t[a]))-Math.max.apply(Math,(0,l.Z)(n[o])):0}else if(n&&n.length){var s=Math.min.apply(Math,(0,l.Z)(t)),c=Math.max.apply(Math,(0,l.Z)(n));s&&c&&(e=s-c)}else e=0;return e>0?e:0}()+r.intervalTime,r.isOpen()&&r.dce.video&&!r.dce.video.paused&&!r._bPauseScan){if(r.bPlaySoundOnSuccessfulRead&&e.length){var a=!1;if(!0===r.bPlaySoundOnSuccessfulRead||"frame"===r.bPlaySoundOnSuccessfulRead)a=!0;else if("unique"===r.bPlaySoundOnSuccessfulRead){var o,s=(0,v.Z)(e);try{for(s.s();!(o=s.n()).done;){if(o.value.bUnduplicated){a=!0;break}}}catch(R){s.e(R)}finally{s.f()}}a&&(r.soundOnSuccessfullRead.currentTime=0,r.soundOnSuccessfullRead.play().catch((function(e){console.warn("Autoplay not allowed. User interaction required: "+(e.message||e))})))}if(navigator.vibrate&&r.bVibrateOnSuccessfulRead&&e.length){var c=!1;if(!0===r.bVibrateOnSuccessfulRead||"frame"===r.bVibrateOnSuccessfulRead)c=!0;else if("unique"===r.bVibrateOnSuccessfulRead){var u,d=(0,v.Z)(e);try{for(d.s();!(u=d.n()).done;){if(u.value.bUnduplicated){c=!0;break}}}catch(R){d.e(R)}finally{d.f()}}if(c)try{navigator.vibrate(r.vibrateDuration)}catch(e){console.warn("Vibration not allowed. User interaction required: "+(e.message||e))}}if(r.onFrameRead){var h,_=r._cloneDecodeResults(e),g=(0,v.Z)(_);try{for(g.s();!(h=g.n()).done;){delete h.value.bUnduplicated}}catch(R){g.e(R)}finally{g.f()}r.onFrameRead(_)}if(r.onUniqueRead){var f,p=(0,v.Z)(e);try{for(p.s();!(f=p.n()).done;){var m=f.value;m.bUnduplicated&&r.onUniqueRead(m.barcodeText,r._cloneDecodeResults(m))}}catch(R){p.e(R)}finally{p.f()}}r._drawResults(e)}r._loopReadVideoTimeoutId&&clearTimeout(r._loopReadVideoTimeoutId),r.intervalTime?r._loopReadVideoTimeoutId=setTimeout((function(){r._loopReadVideo()}),r.intervalTime):r._loopReadVideo()})).catch((function(e){r.dce.stopFetchingLoop(),T._onLog&&T._onLog(e.message||e),r._loopReadVideoTimeoutId&&clearTimeout(r._loopReadVideoTimeoutId),r._loopReadVideoTimeoutId=setTimeout((function(){r._loopReadVideo()}),Math.max(r.intervalTime,1e3)),"platform error"==e.message||console.warn(e.message)}));case 19:case"end":return e.stop()}}),e,this)})))}},{key:"_getVideoFrame",value:function(){var e=this,t=this.dce.isFetchingLoopStarted();if(this.dce.loopInterval=this._intervalGetVideoFrame,t||this.dce.startFetchingLoop(),!this.dce.numberOfFramesInBuffer)return this.dce.loopInterval=0,null;var r=this.dce.getFrameFromBuffer();return function(t){var r=t.timeSpent,n=e.array_getFrameTimeCost;if(e.region instanceof Array){var i=e._indexCurrentDecodingFrame;for(n[i]&&n[i]instanceof Array||(n[i]=[]);n[i].length>=5;)n[i].shift();n[i].push(r)}else{for(;n.length>=5;)n.shift();n.push(r)}}(r),r}},{key:"_drawResults",value:function(e){if(this.dce){this.resultsOverlay||(this.resultsOverlay=this.dce.addScanRegionOverlayCanvas());var t=this.resultsOverlay.getContext("2d");if(t.clearRect(0,0,this.resultsOverlay.width,this.resultsOverlay.height),e){t.globalCompositeOperation="destination-over",t.fillStyle=this.barcodeFillStyle,t.strokeStyle=this.barcodeStrokeStyle,t.lineWidth=this.barcodeLineWidth;var r,n=(0,v.Z)(e);try{for(n.s();!(r=n.n()).done;){var i=r.value.localizationResult;t.beginPath(),t.moveTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.lineTo(i.x3,i.y3),t.lineTo(i.x4,i.y4),t.fill(),t.beginPath(),t.moveTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.lineTo(i.x3,i.y3),t.lineTo(i.x4,i.y4),t.closePath(),t.stroke()}}catch(a){n.e(a)}finally{n.f()}}}}},{key:"open",value:function(){return b(this,void 0,void 0,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._bindUI(),e.next=3,this.dce.open();case 3:return t=e.sent,e.abrupt("return",(this._bPauseScan=!1,this.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideo()),t));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"openVideo",value:function(){return b(this,void 0,void 0,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._bindUI(),e.next=3,this.dce.open();case 3:return t=e.sent,e.abrupt("return",(this._bPauseScan=!0,this.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideo()),t));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){this.dce.close(),this._bPauseScan=!0}},{key:"show",value:function(){return b(this,void 0,void 0,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._bindUI(),e.next=3,this.dce.open(!0);case 3:return t=e.sent,e.abrupt("return",(this._bPauseScan=!1,this.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideo()),t));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"showVideo",value:function(){return b(this,void 0,void 0,u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._bindUI(),e.next=3,this.dce.open(!0);case 3:return t=e.sent,e.abrupt("return",(this._bPauseScan=!0,this.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideo()),t));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"hide",value:function(){this.dce.close(!0),this._bPauseScan=!0}},{key:"destroyContext",value:function(){this.close(),this.bDestroyed||f((0,_.Z)(r.prototype),"destroyContext",this).call(this)}}],[{key:"defaultUIElementURL",get:function(){var e;return null===(e=r._defaultUIElementURL)||void 0===e?void 0:e.replace("@engineResourcePath/",T.engineResourcePath)},set:function(e){r._defaultUIElementURL=e}},{key:"createInstance",value:function(e){return b(this,void 0,void 0,u().mark((function t(){var n,i;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=new r,t.next=3,n.createDCEInstance();case 3:return t.next=5,r.createInstanceInWorker(!0);case 5:for(i in n._instanceID=t.sent,"string"==typeof e&&(e=JSON.parse(e)),e)n[i]=e[i];return t.next=10,n.setUIElement(r.defaultUIElementURL);case 10:if(n.singleFrameMode&&console.warn("The `navigator.mediaDevices.getUserMedia` is unavailable. automatically change to `singleFrameMode`."),t.t0=n.singleFrameMode,t.t0){t.next=15;break}return t.next=15,n.updateRuntimeSettings("single");case 15:return t.abrupt("return",n);case 16:case"end":return t.stop()}}),t)})))}},{key:"isRegionNormalPreset",value:function(e){return 0==e.regionLeft&&0==e.regionTop&&0==e.regionRight&&0==e.regionBottom&&0==e.regionMeasuredByPercentage}}]),r}(T);te._defaultUIElementURL="@engineResourcePath/dbr.ui.html",function(e){e[e.BICM_DARK_ON_LIGHT=1]="BICM_DARK_ON_LIGHT",e[e.BICM_LIGHT_ON_DARK=2]="BICM_LIGHT_ON_DARK",e[e.BICM_DARK_ON_DARK=4]="BICM_DARK_ON_DARK",e[e.BICM_LIGHT_ON_LIGHT=8]="BICM_LIGHT_ON_LIGHT",e[e.BICM_DARK_LIGHT_MIXED=16]="BICM_DARK_LIGHT_MIXED",e[e.BICM_DARK_ON_LIGHT_DARK_SURROUNDING=32]="BICM_DARK_ON_LIGHT_DARK_SURROUNDING",e[e.BICM_SKIP=0]="BICM_SKIP",e[e.BICM_REV=2147483648]="BICM_REV"}(D||(D={})),function(e){e[e.BCM_AUTO=1]="BCM_AUTO",e[e.BCM_GENERAL=2]="BCM_GENERAL",e[e.BCM_SKIP=0]="BCM_SKIP",e[e.BCM_REV=2147483648]="BCM_REV"}(k||(k={})),function(e){e[e.BF2_NULL=0]="BF2_NULL",e[e.BF2_POSTALCODE=32505856]="BF2_POSTALCODE",e[e.BF2_NONSTANDARD_BARCODE=1]="BF2_NONSTANDARD_BARCODE",e[e.BF2_USPSINTELLIGENTMAIL=1048576]="BF2_USPSINTELLIGENTMAIL",e[e.BF2_POSTNET=2097152]="BF2_POSTNET",e[e.BF2_PLANET=4194304]="BF2_PLANET",e[e.BF2_AUSTRALIANPOST=8388608]="BF2_AUSTRALIANPOST",e[e.BF2_RM4SCC=16777216]="BF2_RM4SCC",e[e.BF2_DOTCODE=2]="BF2_DOTCODE",e[e.BF2_PHARMACODE_ONE_TRACK=4]="BF2_PHARMACODE_ONE_TRACK",e[e.BF2_PHARMACODE_TWO_TRACK=8]="BF2_PHARMACODE_TWO_TRACK",e[e.BF2_PHARMACODE=12]="BF2_PHARMACODE"}(C||(C={})),function(e){e[e.BM_AUTO=1]="BM_AUTO",e[e.BM_LOCAL_BLOCK=2]="BM_LOCAL_BLOCK",e[e.BM_SKIP=0]="BM_SKIP",e[e.BM_THRESHOLD=4]="BM_THRESHOLD",e[e.BM_REV=2147483648]="BM_REV"}(M||(M={})),function(e){e[e.ECCM_CONTRAST=1]="ECCM_CONTRAST"}(L||(L={})),function(e){e[e.CFM_GENERAL=1]="CFM_GENERAL"}(x||(x={})),function(e){e[e.CCM_AUTO=1]="CCM_AUTO",e[e.CCM_GENERAL_HSV=2]="CCM_GENERAL_HSV",e[e.CCM_SKIP=0]="CCM_SKIP",e[e.CCM_REV=2147483648]="CCM_REV"}(O||(O={})),function(e){e[e.CICM_GENERAL=1]="CICM_GENERAL",e[e.CICM_SKIP=0]="CICM_SKIP",e[e.CICM_REV=2147483648]="CICM_REV"}(F||(F={})),function(e){e[e.CM_IGNORE=1]="CM_IGNORE",e[e.CM_OVERWRITE=2]="CM_OVERWRITE"}(N||(N={})),function(e){e[e.DM_SKIP=0]="DM_SKIP",e[e.DM_DIRECT_BINARIZATION=1]="DM_DIRECT_BINARIZATION",e[e.DM_THRESHOLD_BINARIZATION=2]="DM_THRESHOLD_BINARIZATION",e[e.DM_GRAY_EQUALIZATION=4]="DM_GRAY_EQUALIZATION",e[e.DM_SMOOTHING=8]="DM_SMOOTHING",e[e.DM_MORPHING=16]="DM_MORPHING",e[e.DM_DEEP_ANALYSIS=32]="DM_DEEP_ANALYSIS",e[e.DM_SHARPENING=64]="DM_SHARPENING",e[e.DM_BASED_ON_LOC_BIN=128]="DM_BASED_ON_LOC_BIN",e[e.DM_SHARPENING_SMOOTHING=256]="DM_SHARPENING_SMOOTHING"}(B||(B={})),function(e){e[e.DRM_AUTO=1]="DRM_AUTO",e[e.DRM_GENERAL=2]="DRM_GENERAL",e[e.DRM_BROAD_WARP=4]="DRM_BROAD_WARP",e[e.DRM_LOCAL_REFERENCE=8]="DRM_LOCAL_REFERENCE",e[e.DRM_DEWRINKLE=16]="DRM_DEWRINKLE",e[e.DRM_SKIP=0]="DRM_SKIP",e[e.DRM_REV=2147483648]="DRM_REV"}(P||(P={})),function(e){e[e.DPMCRM_AUTO=1]="DPMCRM_AUTO",e[e.DPMCRM_GENERAL=2]="DPMCRM_GENERAL",e[e.DPMCRM_SKIP=0]="DPMCRM_SKIP",e[e.DPMCRM_REV=2147483648]="DPMCRM_REV"}(V||(V={})),function(e){e[e.GTM_INVERTED=1]="GTM_INVERTED",e[e.GTM_ORIGINAL=2]="GTM_ORIGINAL",e[e.GTM_SKIP=0]="GTM_SKIP",e[e.GTM_REV=2147483648]="GTM_REV"}(U||(U={})),function(e){e[e.IPM_AUTO=1]="IPM_AUTO",e[e.IPM_GENERAL=2]="IPM_GENERAL",e[e.IPM_GRAY_EQUALIZE=4]="IPM_GRAY_EQUALIZE",e[e.IPM_GRAY_SMOOTH=8]="IPM_GRAY_SMOOTH",e[e.IPM_SHARPEN_SMOOTH=16]="IPM_SHARPEN_SMOOTH",e[e.IPM_MORPHOLOGY=32]="IPM_MORPHOLOGY",e[e.IPM_SKIP=0]="IPM_SKIP",e[e.IPM_REV=2147483648]="IPM_REV"}(G||(G={})),function(e){e[e.IRSM_MEMORY=1]="IRSM_MEMORY",e[e.IRSM_FILESYSTEM=2]="IRSM_FILESYSTEM",e[e.IRSM_BOTH=4]="IRSM_BOTH"}(W||(W={})),function(e){e[e.IRT_NO_RESULT=0]="IRT_NO_RESULT",e[e.IRT_ORIGINAL_IMAGE=1]="IRT_ORIGINAL_IMAGE",e[e.IRT_COLOUR_CLUSTERED_IMAGE=2]="IRT_COLOUR_CLUSTERED_IMAGE",e[e.IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE=4]="IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE",e[e.IRT_TRANSFORMED_GRAYSCALE_IMAGE=8]="IRT_TRANSFORMED_GRAYSCALE_IMAGE",e[e.IRT_PREDETECTED_REGION=16]="IRT_PREDETECTED_REGION",e[e.IRT_PREPROCESSED_IMAGE=32]="IRT_PREPROCESSED_IMAGE",e[e.IRT_BINARIZED_IMAGE=64]="IRT_BINARIZED_IMAGE",e[e.IRT_TEXT_ZONE=128]="IRT_TEXT_ZONE",e[e.IRT_CONTOUR=256]="IRT_CONTOUR",e[e.IRT_LINE_SEGMENT=512]="IRT_LINE_SEGMENT",e[e.IRT_FORM=1024]="IRT_FORM",e[e.IRT_SEGMENTATION_BLOCK=2048]="IRT_SEGMENTATION_BLOCK",e[e.IRT_TYPED_BARCODE_ZONE=4096]="IRT_TYPED_BARCODE_ZONE",e[e.IRT_PREDETECTED_QUADRILATERAL=8192]="IRT_PREDETECTED_QUADRILATERAL"}(H||(H={})),function(e){e[e.LM_SKIP=0]="LM_SKIP",e[e.LM_AUTO=1]="LM_AUTO",e[e.LM_CONNECTED_BLOCKS=2]="LM_CONNECTED_BLOCKS",e[e.LM_LINES=8]="LM_LINES",e[e.LM_STATISTICS=4]="LM_STATISTICS",e[e.LM_SCAN_DIRECTLY=16]="LM_SCAN_DIRECTLY",e[e.LM_STATISTICS_MARKS=32]="LM_STATISTICS_MARKS",e[e.LM_STATISTICS_POSTAL_CODE=64]="LM_STATISTICS_POSTAL_CODE",e[e.LM_CENTRE=128]="LM_CENTRE",e[e.LM_ONED_FAST_SCAN=256]="LM_ONED_FAST_SCAN",e[e.LM_REV=2147483648]="LM_REV"}(Z||(Z={})),function(e){e[e.PDFRM_RASTER=1]="PDFRM_RASTER",e[e.PDFRM_AUTO=2]="PDFRM_AUTO",e[e.PDFRM_VECTOR=4]="PDFRM_VECTOR",e[e.PDFRM_REV=2147483648]="PDFRM_REV"}(J||(J={})),function(e){e[e.QRECL_ERROR_CORRECTION_H=0]="QRECL_ERROR_CORRECTION_H",e[e.QRECL_ERROR_CORRECTION_L=1]="QRECL_ERROR_CORRECTION_L",e[e.QRECL_ERROR_CORRECTION_M=2]="QRECL_ERROR_CORRECTION_M",e[e.QRECL_ERROR_CORRECTION_Q=3]="QRECL_ERROR_CORRECTION_Q"}(K||(K={})),function(e){e[e.RPM_AUTO=1]="RPM_AUTO",e[e.RPM_GENERAL=2]="RPM_GENERAL",e[e.RPM_GENERAL_RGB_CONTRAST=4]="RPM_GENERAL_RGB_CONTRAST",e[e.RPM_GENERAL_GRAY_CONTRAST=8]="RPM_GENERAL_GRAY_CONTRAST",e[e.RPM_GENERAL_HSV_CONTRAST=16]="RPM_GENERAL_HSV_CONTRAST",e[e.RPM_SKIP=0]="RPM_SKIP",e[e.RPM_REV=2147483648]="RPM_REV"}(Y||(Y={})),function(e){e[e.RCT_PIXEL=1]="RCT_PIXEL",e[e.RCT_PERCENTAGE=2]="RCT_PERCENTAGE"}(Q||(Q={})),function(e){e[e.RT_STANDARD_TEXT=0]="RT_STANDARD_TEXT",e[e.RT_RAW_TEXT=1]="RT_RAW_TEXT",e[e.RT_CANDIDATE_TEXT=2]="RT_CANDIDATE_TEXT",e[e.RT_PARTIAL_TEXT=3]="RT_PARTIAL_TEXT"}(j||(j={})),function(e){e[e.SUM_AUTO=1]="SUM_AUTO",e[e.SUM_LINEAR_INTERPOLATION=2]="SUM_LINEAR_INTERPOLATION",e[e.SUM_NEAREST_NEIGHBOUR_INTERPOLATION=4]="SUM_NEAREST_NEIGHBOUR_INTERPOLATION",e[e.SUM_SKIP=0]="SUM_SKIP",e[e.SUM_REV=2147483648]="SUM_REV"}(X||(X={})),function(e){e[e.TP_REGION_PREDETECTED=1]="TP_REGION_PREDETECTED",e[e.TP_IMAGE_PREPROCESSED=2]="TP_IMAGE_PREPROCESSED",e[e.TP_IMAGE_BINARIZED=4]="TP_IMAGE_BINARIZED",e[e.TP_BARCODE_LOCALIZED=8]="TP_BARCODE_LOCALIZED",e[e.TP_BARCODE_TYPE_DETERMINED=16]="TP_BARCODE_TYPE_DETERMINED",e[e.TP_BARCODE_RECOGNIZED=32]="TP_BARCODE_RECOGNIZED"}(z||(z={})),function(e){e[e.TFM_AUTO=1]="TFM_AUTO",e[e.TFM_GENERAL_CONTOUR=2]="TFM_GENERAL_CONTOUR",e[e.TFM_SKIP=0]="TFM_SKIP",e[e.TFM_REV=2147483648]="TFM_REV"}(q||(q={})),function(e){e[e.TROM_CONFIDENCE=1]="TROM_CONFIDENCE",e[e.TROM_POSITION=2]="TROM_POSITION",e[e.TROM_FORMAT=4]="TROM_FORMAT",e[e.TROM_SKIP=0]="TROM_SKIP",e[e.TROM_REV=2147483648]="TROM_REV"}($||($={})),function(e){e[e.TDM_AUTO=1]="TDM_AUTO",e[e.TDM_GENERAL_WIDTH_CONCENTRATION=2]="TDM_GENERAL_WIDTH_CONCENTRATION",e[e.TDM_SKIP=0]="TDM_SKIP",e[e.TDM_REV=2147483648]="TDM_REV"}(ee||(ee={})),T.engineResourcePath="https://cdn.jsdelivr.net/npm/dynamsoft-javascript-barcode@9.0.0/dist/",I.defaultUIElementURL="https://cdn.jsdelivr.net/npm/dynamsoft-camera-enhancer@2.3.1/dist/dce.ui.html";var re=function(e){(0,o.Z)(r,e);var t=(0,s.Z)(r);function r(){var e;return(0,i.Z)(this,r),(e=t.apply(this,arguments)).reader=null,e.enhancer=null,e.decoding=!1,e}return(0,a.Z)(r,[{key:"toggleTorch",value:function(){var e=(0,n.Z)(u().mark((function e(t){var r,n;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.enhancer){e.next=8;break}e.prev=1,t.on?null===(r=this.enhancer)||void 0===r||r.turnOnTorch():null===(n=this.enhancer)||void 0===n||n.turnOffTorch(),e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(1),new Error("Torch unsupported");case 8:case"end":return e.stop()}}),e,this,[[1,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"stopScan",value:function(){var e=(0,n.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.stopDecoding(),null===(t=this.enhancer)||void 0===t||t.close(!0),e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"pauseScan",value:function(){var e=(0,n.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,this.stopDecoding(),null===(t=this.enhancer)||void 0===t||t.pause(),e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),e.t0;case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()},{key:"resumeScan",value:function(){var e=(0,n.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,null===(t=this.enhancer)||void 0===t?void 0:t.resume();case 3:this.startDecoding(),e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(0),e.t0;case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"destroy",value:function(){var e=(0,n.Z)(u().mark((function e(){var t,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.stopDecoding(),null===(t=this.enhancer)||void 0===t||t.dispose(!0),null===(r=this.reader)||void 0===r||r.destroyContext(),this.enhancer=null,this.reader=null;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initialize",value:function(){var e=(0,n.Z)(u().mark((function e(t){var r=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.reader){e.next=19;break}return t&&t.license&&(T.license=t.license),e.next=4,I.createInstance();case 4:return this.enhancer=e.sent,e.next=7,te.createInstance();case 7:return this.reader=e.sent,e.next=10,this.reader.updateRuntimeSettings("balance");case 10:return this.enhancer.on("played",(function(e){r.notifyListeners("onPlayed",{resolution:e.width+"x"+e.height})})),e.next=13,this.enhancer.setUIElement("https://cdn.jsdelivr.net/npm/dynamsoft-camera-enhancer@2.3.1/dist/dce.ui.html");case 13:this.enhancer.getUIElement().getElementsByClassName("dce-btn-close")[0].remove(),this.enhancer.getUIElement().getElementsByClassName("dce-sel-camera")[0].remove(),this.enhancer.getUIElement().getElementsByClassName("dce-sel-resolution")[0].remove(),this.enhancer.getUIElement().getElementsByClassName("dce-msg-poweredby")[0].remove(),e.next=20;break;case 19:console.log("Scanner already initialized.");case 20:return e.abrupt("return",{success:!0});case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"captureAndDecode",value:function(){var e=(0,n.Z)(u().mark((function e(){var t,r,n,i,a,o,s,c,d;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.enhancer&&null!=this.reader){e.next=2;break}return e.abrupt("return");case 2:if(0!=this.enhancer.isOpen()){e.next=4;break}return e.abrupt("return");case 4:if(1!=this.decoding){e.next=6;break}return e.abrupt("return");case 6:if(!(t=this.enhancer.getFrame())){e.next=17;break}return this.decoding=!0,e.next=11,this.reader.decode(t);case 11:for(r=e.sent,this.decoding=!1,n=[],i=0;i<r.length;i++)a=r[i],void 0,s=0,c=0,1==t.isCropped&&(s=t.sx,c=t.sy),o={barcodeText:a.barcodeText,barcodeFormat:a.barcodeFormatString,barcodeBytesBase64:this.arrayBufferToBase64(a.barcodeBytes),x1:a.localizationResult.x1+s,y1:a.localizationResult.y1+c,x2:a.localizationResult.x2+s,y2:a.localizationResult.y2+c,x3:a.localizationResult.x3+s,y3:a.localizationResult.y3+c,x4:a.localizationResult.x4+s,y4:a.localizationResult.y4+c},n.push(o);d={results:n},this.notifyListeners("onFrameRead",d);case 17:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setScanRegion",value:function(){var e=(0,n.Z)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return null===(r=this.enhancer)||void 0===r||r.setScanRegion({regionLeft:t.left,regionTop:t.top,regionRight:t.right,regionBottom:t.bottom,regionMeasuredByPercentage:t.measuredByPercentage}),e.abrupt("return",{success:!0});case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"initRuntimeSettingsWithString",value:function(){var e=(0,n.Z)(u().mark((function e(t){var r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.template){e.next=4;break}return e.next=3,null===(r=this.reader)||void 0===r?void 0:r.initRuntimeSettingsWithString(t.template);case 3:console.log("Using template");case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"startScan",value:function(){var e=(0,n.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(t=this.enhancer)||void 0===t?void 0:t.open(!0);case 2:this.startDecoding();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"startDecoding",value:function(){this.interval&&clearInterval(this.interval),this.decoding=!1,this.interval=setInterval(this.captureAndDecode.bind(this),100)}},{key:"stopDecoding",value:function(){this.interval&&clearInterval(this.interval),this.decoding=!1}},{key:"arrayBufferToBase64",value:function(e){for(var t="",r=new Uint8Array(e),n=r.byteLength,i=0;i<n;i++)t+=String.fromCharCode(r[i]);return window.btoa(t)}},{key:"getAllCameras",value:function(){var e=(0,n.Z)(u().mark((function e(){var t,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.enhancer){e.next=7;break}return e.next=3,this.enhancer.getAllCameras();case 3:return t=e.sent,r=[],t.forEach((function(e){r.push(e.label)})),e.abrupt("return",{cameras:r});case 7:return e.abrupt("return",{message:"not initialized"});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"selectCamera",value:function(){var e=(0,n.Z)(u().mark((function e(t){var r=this;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.enhancer){e.next=8;break}return e.next=3,this.enhancer.getAllCameras();case 3:return e.sent.forEach(function(){var e=(0,n.Z)(u().mark((function e(n){var i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.label!=t.cameraID){e.next=4;break}return e.next=3,null===(i=r.enhancer)||void 0===i?void 0:i.selectCamera(n);case 3:return e.abrupt("return",{success:!0});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",{message:"not found"});case 8:return e.abrupt("return",{message:"not initialized"});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSelectedCamera",value:function(){var e=(0,n.Z)(u().mark((function e(){var t;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.enhancer){e.next=5;break}return t=this.enhancer.getSelectedCamera(),e.abrupt("return",{selectedCamera:t.label});case 5:return e.abrupt("return",{message:"not initialized"});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getResolution",value:function(){var e=(0,n.Z)(u().mark((function e(){var t,r;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.enhancer){e.next=6;break}return t=this.enhancer.getResolution(),r=t[0]+"x"+t[1],e.abrupt("return",{resolution:r});case 6:return e.abrupt("return",{message:"not initialized"});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setResolution",value:function(){var e=(0,n.Z)(u().mark((function e(t){var r,n,i;return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.enhancer){e.next=10;break}return r=t.resolution,n=1280,i=720,r==h.F.RESOLUTION_480P?(n=640,i=480):r==h.F.RESOLUTION_720P?(n=1280,i=720):r==h.F.RESOLUTION_1080P?(n=1920,i=1080):r==h.F.RESOLUTION_2K?(n=2560,i=1440):r==h.F.RESOLUTION_4K&&(n=3840,i=2160),e.next=7,this.enhancer.setResolution(n,i);case 7:return e.abrupt("return",{success:!0});case 10:return e.abrupt("return",{message:"not initialized"});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setZoom",value:function(){var e=(0,n.Z)(u().mark((function e(t){return u().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.enhancer){e.next=6;break}return e.next=3,this.enhancer.setZoom(t.factor);case 3:return e.abrupt("return",{success:!0});case 6:return e.abrupt("return",{message:"not initialized"});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setFocus",value:function(e){throw new Error("Method not implemented.")}}]),r}(d.Uw)}}]);
//# sourceMappingURL=2604.b905621f.chunk.js.map